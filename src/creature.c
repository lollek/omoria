/* creature.c */
/**/

#include <curses.h>
#include <math.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h> /* for ftruncate, usleep */

#include "configure.h"
#include "constants.h"
#include "debug.h"
#include "desc.h"
#include "effects.h"
#include "fighting.h"
#include "inven.h"
#include "magic.h"
#include "misc.h"
#include "monsters.h"
#include "pascal.h"
#include "player.h"
#include "player_action.h"
#include "random.h"
#include "screen.h"
#include "spells.h"
#include "term.h"
#include "types.h"
#include "variables.h"

#include "creature.h"

#define ML(mmm) (m_list[(mmm)])
#define MY(mmm) (m_list[(mmm)].fy)
#define MX(mmm) (m_list[(mmm)].fx)
#define OBJ_RUNE_PROT 3000 /*{ Rune of protection resistance	} */

typedef long mm_type[6];

long const m_level[MAX_MONS_LEVEL + 1] = {
    18,  14,  33,  51,  63,  77,  87,  97,  104, 114, 129, 135, 152, 162, 170,
    186, 196, 201, 208, 215, 229, 234, 239, 247, 252, 262, 269, 274, 282, 288,
    298, 304, 311, 315, 320, 336, 343, 351, 358, 363, 373, 373, 375, 375, 375,
    376, 376, 376, 377, 377, 379, 379, 379, 379, 379, 379, 380, 380, 380, 380,
    382, 382, 382, 382, 383, 383, 383, 383, 383, 383, 384, 384, 384, 384, 384,
    384, 384, 384, 384, 384, 385, 385, 385, 385, 385, 385, 385, 385, 385, 385,
    385, 385, 385, 385, 385, 385, 385, 385, 385, 393, 395};

monster_template const monster_templates[] = {
    {10, 1, "<<Placeholder>>", 0x0010C000, 0x00009F52, 0x3000, 25000, 50, 1,
     'p', "20d8", "1 1 3d3", 0, 20},
    {10, 1, "Town Wizard", 0x0010C000, 0x00009F52, 0x3000, 25000, 50, 1, 'p',
     "20d8", "1 1 3d3", 0, 20},
    {10, 1, "Town Guard", 0x0010C000, 0x00000000, 0x3000, 25000, 25, 1, 'p',
     "20d8", "1 1 4d4|1 1 4d4", 0, 0},
    {4, 1, "Young Child", 0x14124342, 0x00000000, 0x2034, 50, 10, 1, 'p', "1d2",
     "1 6 0d0", 0, 0},
    {20, 20, "Goldfish", 0x00004054, 0x00000000, 0x00F0, 0, 5, 1, 'f', "0d0",
     "1 32 0d0", 0, 0},
    {20, 10, "Rhode Island Red", 0x00000348, 0x00000000, 0x20F0, 10, 5, 2, 'c',
     "1d1", "1 34 0d0|1 37 0d0", 0, 0},
    {20, 10, "Quack! Quack! Duck", 0x00004348, 0x00000000, 0x20F0, 10, 5, 2,
     'd', "1d1", "1 33 0d0", 0, 0},
    {20, 10, "Mongrel Dog", 0x00004348, 0x00000000, 0x20F0, 10, 5, 2, 'd',
     "1d1", "1 35 0d0", 0, 0},
    {20, 10, "Stray Kitten", 0x00004348, 0x00000000, 0x20F0, 10, 5, 2, 'k',
     "1d1", "1 36 0d0", 0, 0},
    {20, 20, "Moo Cow", 0x00004348, 0x00000000, 0x20F0, 10, 10, 1, 'B', "3d8",
     "1 26 0d0", 0, 0},
    {20, 25, "Raging Bull", 0x00080348, 0x00000000, 0x20F0, 50, 0, 2, 'B',
     "4d8", "1 25 1d6", 0, 0},
    {4, 1, "Filthy Street Urchin", 0x00120342, 0x00000000, 0x2034, 400, 0, 1,
     'p', "1d4", "1 14 0d0|12 5 0d0", 0, 0},
    {6, 1, "Blubbering Idiot", 0x00124342, 0x00000000, 0x2030, 0, 10, 1, 'p',
     "1d2", "1 18 0d0", 0, 0},
    {10, 1, "Pitiful Looking Beggar", 0x00124342, 0x00000000, 0x2030, 400, 10,
     1, 'p', "1d4", "1 14 0d0", 0, 0},
    {10, 1, "Mangy Looking Leper", 0x00124342, 0x00000000, 0x2030, 500, 10, 1,
     'p', "1d1", "1 14 0d0", 0, 0},
    {10, 8, "Squint Eyed Rogue", 0x07120340, 0x00000000, 0x2034, 999, 0, 1, 'p',
     "2d8", "1 1 1d6|13 5 0d0", 0, 0},
    {10, 1, "Singing, Happy Drunk", 0x0612434E, 0x00000000, 0x2030, 0, 10, 1,
     'p', "2d3", "1 14 0d0", 0, 0},
    {10, 20, "Mean Looking Mercenary", 0x0B120342, 0x00000000, 0x2034, 25000, 0,
     1, 'p', "5d8", "1 1 1d10", 0, 0},
    {10, 30, "Battle Scarred Veteran", 0x0B120342, 0x00000000, 0x2030, 25000, 0,
     1, 'p', "7d8", "1 1 2d6", 0, 0},
    {6, 5, "Brown Spider", 0x00200204, 0x00000000, 0x0030, 8, 2, 1, 'x', "3d4",
     "1 2 1d3", 1, 0},
    {2, 1, "False Stairwell", 0x00000041, 0x00000028, 0x0000, 0, 2, 1, '<',
     "5d4", "10 5 0d0", 1, 0},
    {2, 1, "Grey Mushroom patch", 0x00000041, 0x00000000, 0x10A0, 0, 1, 1, ',',
     "1d2", "3 13 1d4", 1, 0},
    {8, 12, "Giant Yellow Centipede", 0x00000040, 0x00000000, 0x0002, 300, 2, 1,
     'c', "2d6", "1 2 1d3|1 4 1d3", 1, 0},
    {7, 10, "Giant White Centipede", 0x00000042, 0x00000000, 0x0002, 400, 2, 1,
     'c', "3d5", "1 2 1d2|1 4 1d2", 1, 0},
    {12, 7, "White Icky-Thing", 0x00000144, 0x00000000, 0x0022, 100, 2, 1, 'i',
     "3d5", "1 5 1d2", 1, 0},
    {12, 6, "Clear Icky-Thing", 0x00010140, 0x00000000, 0x0022, 100, 1, 1, 'i',
     "2d5", "1 5 1d2", 1, 0},
    {8, 4, "Giant White Mouse", 0x00200202, 0x00000000, 0x2070, 200, 1, 1, 'r',
     "1d3", "1 2 1d2", 1, 0},
    {4, 35, "Large Brown Snake", 0x00000142, 0x00000000, 0x00B0, 999, 3, 0, 'R',
     "4d6", "1 2 1d3|1 16 1d4", 1, 0},
    {4, 30, "Large White Snake", 0x00000144, 0x00000000, 0x00B0, 999, 2, 1, 'R',
     "3d6", "1 2 1d1", 1, 0},
    {20, 16, "Kobold", 0x07020200, 0x00000000, 0x2032, 100, 5, 1, 'k', "3d7",
     "1 1 1d6", 1, 0},
    {6, 1, "White Worm mass", 0x00200148, 0x00000000, 0x01B0, 1, 2, 0, 'w',
     "4d4", "14 12 1d2", 1, 0},
    {2, 6, "Floating Eye", 0x00800001, 0x0001000D, 0x2102, 100, 1, 1, 'e',
     "3d6", "11 7 0d0", 1, 0},
    {5, 5, "Leech", 0x00300211, 0x00000000, 0x0070, 1000, 2, 2, 'l', "1d1",
     "1 30 2d2", 1, 0},
    {6, 5, "Black Spider", 0x00200204, 0x00000000, 0x0030, 10, 3, 1, 'x', "2d3",
     "6 2 1d3|1 2 1d4", 2, 0},
    {2, 1, "Shrieker Mushroom patch", 0x00000001, 0x00000000, 0x10A0, 0, 1, 1,
     ',', "1d1", "20 10 0d0", 2, 0},
    {10, 4, "Blubbering Icky-Thing", 0x0B180144, 0x00000000, 0x0022, 100, 8, 1,
     'i', "5d8", "14 12 1d4|22 12 0d0", 2, 0},
    {5, 4, "Metallic Green Centipede", 0x00000144, 0x00000000, 0x0000, 100, 3,
     1, 'c', "4d4", "1 12 1d1", 2, 0},
    {1, 1, "Glowing Chartreuse Potion", 0x00000041, 0x00000000, 0x11F2, 0, 2, 1,
     '!', "7d4", "1 2 1d3|1 3 1d3", 2, 0},
    {20, 16, "Jester", 0x07020200, 0x0000040C, 0x2070, 50, 6, 1, 'p', "7d4",
     "1 1 1d5|11 23 1d2", 2, 0},
    {20, 16, "Novice Warrior", 0x07020200, 0x00000000, 0x2070, 50, 6, 1, 'p',
     "9d4", "1 1 1d7", 2, 0},
    {20, 12, "Novice Rogue", 0x07020200, 0x00000000, 0x2070, 50, 6, 1, 'p',
     "8d4", "1 1 1d6|12 5 0d0", 2, 0},
    {20, 10, "Novice Priest", 0x07020200, 0x0000108C, 0x2070, 100, 7, 1, 'p',
     "7d4", "1 1 1d5", 2, 0},
    {20, 6, "Novice Mage", 0x07020200, 0x0000089C, 0x2070, 50, 7, 1, 'p', "6d4",
     "1 1 1d4", 2, 0},
    {2, 1, "Yellow Mushroom patch", 0x00000041, 0x00000000, 0x10A0, 0, 2, 1,
     ',', "1d1", "4 13 1d6", 2, 0},
    {2, 1, "White Jelly", 0x0B000041, 0x00000000, 0x01A0, 999, 10, 1, 'J',
     "8d8", "14 5 1d2", 2, 0},
    {14, 8, "Giant Green Frog", 0x00001212, 0x00000000, 0x0082, 300, 6, 2, 'a',
     "2d8", "1 2 1d3", 2, 0},
    {14, 20, "Giant Black Ant", 0x00000142, 0x00000000, 0x0002, 400, 8, 1, 'c',
     "3d6", "1 2 1d4", 2, 0},
    {16, 16, "White Harpy", 0x00800304, 0x00000000, 0x2036, 100, 5, 1, 'h',
     "2d5", "1 3 1d1|1 3 1d1|1 2 1d2", 2, 0},
    {18, 14, "Blue Yeek", 0x07020240, 0x00000000, 0x2030, 100, 4, 1, 'y', "2d6",
     "1 1 1d5", 2, 0},
    {7, 3, "Green Worm mass", 0x00200148, 0x00000000, 0x01B0, 100, 3, 0, 'w',
     "6d4", "9 12 1d3", 2, 0},
    {5, 38, "Large Black Snake", 0x00000142, 0x00000000, 0x00B0, 750, 9, 0, 'R',
     "4d8", "1 2 1d4|1 16 1d6", 2, 0},
    {4, 10, "Giant Kelp", 0x00600013, 0x00000000, 0x1030, 0, 3, 1, 'w', "2d4",
     "1 29 1d8", 2, 0},
    {6, 10, "Red Spider", 0x00200208, 0x00000000, 0x0012, 15, 4, 1, 'x', "3d3",
     "5 2 2d3", 3, 0},
    {8, 15, "Poltergeist", 0x0F95030E, 0x0000001F, 0x100C, 750, 6, 3, 'G',
     "2d5", "4 1 1d1", 3, 0},
    {6, 6, "Metallic Blue Centipede", 0x00000144, 0x00000000, 0x0000, 150, 7, 2,
     'c', "4d5", "1 12 1d2", 3, 0},
    {1, 1, "Scroll Titled \"taf naed\"", 0x00000041, 0x00000000, 0x1010, 0, 7,
     1, '?', "10d8", "1 1 3d2", 3, 0},
    {6, 5, "Giant White Lice", 0x00200148, 0x00000000, 0x01F0, 100, 1, 2, 'l',
     "1d1", "1 2 1d1", 3, 0},
    {16, 40, "Black Naga", 0x07100302, 0x00000000, 0x20E6, 1200, 20, 1, 'n',
     "6d8", "1 16 1d8", 3, 0},
    {2, 1, "Spotted Mushroom patch", 0x00000041, 0x00000000, 0x10A0, 0, 3, 1,
     ',', "1d1", "14 13 2d4", 3, 0},
    {2, 1, "Yellow Jelly", 0x0B000041, 0x0001000F, 0x01A0, 999, 12, 1, 'J',
     "10d8", "14 5 1d3", 3, 0},
    {16, 8, "Scruffy looking Hobbit", 0x05020200, 0x00000000, 0x2070, 100, 4, 1,
     'p', "3d5", "1 1 1d4|12 5 0d0", 3, 0},
    {8, 12, "Huge Brown Bat", 0x00800308, 0x00000000, 0x2160, 400, 4, 3, 'b',
     "2d6", "1 2 1d2", 3, 0},
    {8, 16, "Giant White Ant", 0x00000140, 0x00000000, 0x0002, 800, 7, 1, 'c',
     "3d6", "1 2 1d4", 3, 0},
    {2, 10, "Yellow Mold", 0x0B000041, 0x00000000, 0x10A0, 999, 9, 1, 'm',
     "8d8", "1 1 1d4", 3, 0},
    {8, 9, "Metallic Red Centipede", 0x00000142, 0x00000000, 0x0092, 200, 12, 2,
     'c', "4d8", "1 12 1d2", 3, 0},
    {7, 4, "Yellow Worm mass", 0x00200148, 0x00000000, 0x01B0, 100, 4, 0, 'w',
     "4d8", "15 12 1d3", 3, 0},
    {5, 40, "Large Grey Snake", 0x00000242, 0x00000000, 0x00B0, 700, 10, 0, 'R',
     "6d8", "1 2 1d4|1 16 1d6", 3, 0},
    {2, 6, "Radiation Eye", 0x00800301, 0x0001000B, 0x2102, 100, 6, 1, 'e',
     "3d6", "2 7 1d6", 3, 0},
    {16, 22, "Drooling Harpy", 0x00800304, 0x00000000, 0x2036, 100, 7, 1, 'h',
     "2d8", "1 3 1d1|1 3 1d1|1 2 1d2|1 18 0d0", 3, 0},
    {8, 15, "Spider named Boris", 0x00000202, 0x00000000, 0x2030, 80, 15, 2,
     'x', "5d6", "1 2 2d3", 3, 0},
    {6, 10, "White Spider", 0x00200204, 0x00000000, 0x0022, 20, 4, 1, 'x',
     "5d4", "7 2 3d3", 4, 0},
    {8, 5, "Silver Mouse", 0x00200202, 0x00000000, 0x2072, 100, 1, 1, 'r',
     "1d1", "23 1 1d1|1 1 1d1", 4, 0},
    {8, 10, "Pirhana", 0x00200050, 0x00000000, 0x00F0, 0, 4, 2, 'f', "1d8",
     "1 2 2-1d2", 4, 0},
    {2, 1, "Black Mushroom patch", 0x00000041, 0x00000000, 0x10A0, 0, 8, 1, ',',
     "8d8", "1 13 1d3", 4, 0},
    {2, 1, "Blue Jelly", 0x0B000041, 0x00000000, 0x01A0, 999, 14, 1, 'J',
     "12d8", "7 5 1d6", 4, 0},
    {3, 24, "Creeping Copper Coins", 0x06000300, 0x00000000, 0x0002, 100, 9, 0,
     '$', "7d8", "1 2 1d4|14 8 2d4", 4, 0},
    {8, 7, "Giant White Rat", 0x00200202, 0x00000000, 0x2070, 300, 1, 1, 'r',
     "2d2", "14 2 1d3", 4, 0},
    {8, 20, "Giant Black Centipede", 0x00000248, 0x00000000, 0x0002, 300, 11, 1,
     'c', "5d8", "1 2 1d2|1 4 1d2", 4, 0},
    {8, 20, "Giant Blue Centipede", 0x00000240, 0x00000000, 0x0002, 500, 10, 1,
     'c', "4d8", "1 2 1d3|1 4 1d4", 4, 0},
    {7, 12, "Blue Worm mass", 0x00200248, 0x00000000, 0x01B0, 100, 5, 0, 'w',
     "5d8", "7 12 1d4", 4, 0},
    {6, 41, "Large Grey Snake", 0x00000242, 0x00000000, 0x00B0, 500, 14, 0, 'R',
     "6d8", "1 2 1d5|1 16 1d8", 4, 0},
    {12, 16, "Jackal", 0x00000204, 0x00000000, 0x2030, 300, 8, 1, 'j', "3d8",
     "1 2 1d6", 4, 0},
    {20, 40, "Green Naga", 0x07100302, 0x00000000, 0x2066, 1200, 30, 1, 'n',
     "9d8", "1 16 1d8|6 9 2d6", 5, 0},
    {10, 20, "Green Glutton Ghost", 0x0F950300, 0x0000003F, 0x100C, 100, 15, 3,
     'G', "3d6", "22 15 1d1", 5, 0},
    {2, 1, "White Mushroom patch", 0x00000041, 0x00000000, 0x10A0, 0, 5, 1, ',',
     "1d1", "11 13 2d4", 5, 0},
    {2, 1, "Green Jelly", 0x0B000041, 0x00000000, 0x01A0, 999, 18, 1, 'J',
     "22d8", "9 5 1d2", 5, 0},
    {20, 26, "Skeleton Kobold", 0x00020300, 0x00000000, 0x000C, 400, 12, 1, 's',
     "5d8", "1 1 1d6", 5, 0},
    {2, 25, "Silver Jelly", 0x0B000041, 0x00000000, 0x00B0, 1, 15, 1, 'J',
     "20d8", "23 5 1d3", 5, 0},
    {12, 18, "Giant Warty Frog", 0x00000312, 0x00000000, 0x00A2, 400, 12, 1,
     'a', "4d8", "1 2 1d6", 5, 0},
    {14, 12, "Grey Icky-Thing", 0x00000144, 0x00000000, 0x0022, 150, 10, 1, 'i',
     "4d8", "1 5 1d5", 5, 0},
    {4, 10, "Disenchanter Eye", 0x00800303, 0x00010009, 0x2102, 100, 20, 1, 'e',
     "7d8", "21 7 0d0", 5, 5},
    {18, 16, "Black Yeek", 0x07020240, 0x00000000, 0x2030, 100, 8, 1, 'y',
     "2d8", "1 1 1d5", 5, 0},
    {7, 12, "Red Worm mass", 0x00200148, 0x00000000, 0x21B0, 100, 6, 0, 'w',
     "5d8", "5 12 1d6", 5, 0},
    {12, 16, "Giant House Fly", 0x00800304, 0x00000000, 0x0062, 200, 10, 3, 'F',
     "3d8", "1 2 1d2", 5, 0},
    {6, 20, "Copperhead Snake", 0x00000244, 0x00000000, 0x00B0, 1, 15, 1, 'R',
     "4d6", "14 2 2d4", 5, 0},
    {2, 30, "Rot Jelly", 0x0B000041, 0x00000000, 0x00B0, 1, 15, 1, 'J', "20d8",
     "22 5 2d3", 5, 0},
    {35, 80, "Swirling Red Vapor", 0x00800308, 0x00000000, 0x1100, 20, 15, 2,
     'v', "3d8", "1 5 1d4", 6, 0},
    {12, 16, "Blink Dog", 0x00000304, 0x00000013, 0x2030, 300, 12, 1, 'j',
     "3d8", "1 2 1d6", 6, 0},
    {2, 1, "Purple Mushroom patch", 0x00000041, 0x00000000, 0x10A0, 0, 12, 1,
     ',', "1d1", "16 13 1d2", 6, 0},
    {2, 12, "Brown Mold", 0x0B000041, 0x00000000, 0x10A0, 999, 20, 1, 'm',
     "15d8", "3 1 1d4", 6, 0},
    {10, 15, "Giant Brown Bat", 0x00800306, 0x00000000, 0x2160, 300, 10, 3, 'b',
     "3d8", "1 2 1d3", 6, 0},
    {4, 30, "Creeping Silver Coins", 0x0A000300, 0x00000000, 0x0002, 100, 18, 0,
     '$', "12d8", "1 2 1d6|14 8 2d6", 6, 0},
    {20, 32, "Orc", 0x0B020200, 0x00000000, 0x2036, 300, 16, 1, 'o', "9d8",
     "1 1 1d8", 6, 0},
    {16, 20, "Grey Harpy", 0x00800310, 0x00000000, 0x2036, 100, 14, 2, 'h',
     "3d8", "1 3 1d2|1 3 1d2|1 2 1d2", 6, 0},
    {18, 14, "Blue Icky-Thing", 0x00000144, 0x00000000, 0x0022, 200, 12, 1, 'i',
     "4d8", "7 5 2d3", 6, 0},
    {6, 24, "Rattlesnake", 0x00000244, 0x00000000, 0x00B0, 1, 20, 1, 'R', "6d7",
     "14 2 2d5", 6, 0},
    {2, 6, "Bloodshot Eye", 0x00800301, 0x00010007, 0x2102, 100, 15, 1, 'e',
     "4d8", "10 7 2d6", 7, 0},
    {20, 40, "Red Naga", 0x07100302, 0x00000000, 0x20E6, 1200, 40, 1, 'n',
     "11d8", "1 16 1d10|2 2 1d4", 7, 0},
    {2, 1, "Red Jelly", 0x0B000041, 0x00000000, 0x01A0, 999, 26, 1, 'J', "26d8",
     "2 5 1d5", 7, 0},
    {12, 16, "Giant Red Frog", 0x00000312, 0x00000000, 0x00A2, 500, 16, 1, 'a',
     "5d8", "2 2 2d4", 7, 0},
    {14, 12, "Green Icky-Thing", 0x00000144, 0x00000000, 0x0022, 200, 18, 1,
     'i', "5d8", "9 5 2d5", 7, 0},
    {20, 14, "Zombie Kobold", 0x00020300, 0x00000000, 0x002E, 300, 14, 1, 'z',
     "6d8", "1 1 1d2|1 1 1d2", 7, 0},
    {20, 14, "Walking Dead", 0x00220302, 0x00001006, 0x002E, 300, 12, 0, 'z',
     "3d6", "1 1 1d2|1 1 1d2|14 8 1d2", 7, 0},
    {4, 10, "Lost Soul", 0x00950306, 0x0001002F, 0x100C, 100, 18, 1, 'G', "2d8",
     "1 1 2d2|18 5 0d0", 7, 0},
    {18, 14, "Greedy little Gnome", 0x0B020240, 0x00000000, 0x2070, 100, 13, 1,
     'p', "3d8", "1 1 1d7|13 5 0d0", 7, 0},
    {12, 14, "Giant Green Fly", 0x00800308, 0x00000000, 0x0062, 500, 15, 2, 'F',
     "3d8", "1 2 1d4", 7, 0},
    {10, 25, "Red Faerie Dragon", 0x11820302, 0x00008496, 0x4001, 50, 25, 2,
     'F', "3d8", "3 3 1d5", 8, 0},
    {18, 18, "Brown Yeek", 0x07020240, 0x00000000, 0x2030, 100, 11, 1, 'y',
     "3d8", "1 1 1d6", 8, 0},
    {2, 14, "Green Mold", 0x0B000041, 0x00000000, 0x10A0, 750, 28, 1, 'm',
     "21d8", "4 1 1d4", 8, 0},
    {20, 36, "Skeleton Orc", 0x00020300, 0x00000000, 0x100C, 400, 26, 1, 's',
     "10d8", "1 1 2d5", 8, 0},
    {20, 26, "Seedy looking Human", 0x13020200, 0x00000000, 0x2034, 200, 22, 1,
     'p', "8d8", "1 1 3d4", 8, 0},
    {14, 18, "Red Icky-Thing", 0x00000144, 0x00000000, 0x0022, 200, 22, 2, 'i',
     "4d8", "1 5 1d3|6 8 1d5", 8, 0},
    {20, 24, "Bandit", 0x13020200, 0x00000000, 0x2030, 999, 26, 1, 'p', "8d8",
     "1 1 2d4|12 5 0d0", 8, 0},
    {20, 25, "Giant Squid", 0x00000250, 0x00000000, 0x0042, 500, 25, 2, 'C',
     "4d4", "10 28 0d0|1 11 1d8", 9, 0},
    {20, 24, "Yeti", 0x00020200, 0x00000000, 0x2024, 100, 30, 1, 'Y', "11d8",
     "1 3 1d3|1 3 1d3|1 2 1d4", 9, 0},
    {14, 18, "Bloodshot Icky-Thing", 0x00000142, 0x0001000B, 0x2022, 800, 24, 1,
     'i', "7d8", "1 5 1d4|9 8 2d4", 9, 0},
    {10, 12, "Giant Grey Rat", 0x00200202, 0x00000000, 0x2070, 200, 2, 1, 'r',
     "2d3", "14 2 1d4", 9, 0},
    {16, 22, "Black Harpy", 0x00800302, 0x00000000, 0x2036, 100, 19, 2, 'h',
     "3d8", "1 3 1d2|1 3 1d2|1 2 1d3", 9, 0},
    {12, 18, "Giant Black Bat", 0x00800304, 0x00000000, 0x2060, 250, 16, 3, 'b',
     "2d8", "1 2 1d6", 9, 0},
    {18, 24, "Clear Yeek", 0x07030240, 0x00000000, 0x0030, 100, 14, 1, 'y',
     "3d6", "1 1 1d5", 9, 0},
    {20, 15, "Orc Shaman", 0x0B020200, 0x00008085, 0x2036, 200, 30, 1, 'o',
     "7d8", "1 1 1d6", 9, 0},
    {12, 34, "Giant Red Ant", 0x00000140, 0x00000000, 0x0002, 600, 22, 1, 'c',
     "4d8", "1 2 1d4|2 4 1d4", 9, 0},
    {8, 30, "King Cobra", 0x00000244, 0x00000000, 0x00B0, 1, 28, 1, 'R', "8d8",
     "10 9 1d2|14 2 3d4", 9, 0},
    {4, 1, "Clear Mushroom patch", 0x00210041, 0x00000000, 0x00A0, 0, 1, 2, ',',
     "1d1", "1 13 1d1", 10, 0},
    {1, 0, "Wimp", 0x00000000, 0x00000000, 0x0000, 1000, 0, 1, 'p', "1d1",
     "1 1 0d0", 10, 0},
    {12, 40, "Giant White Tick", 0x00000242, 0x00000000, 0x0022, 200, 27, 0,
     't', "15d8", "14 2 2d6", 10, 0},
    {2, 15, "Hairy Mold", 0x0B000041, 0x00000000, 0x10A0, 700, 32, 1, 'm',
     "15d8", "14 1 1d3", 10, 0},
    {2, 20, "Disenchanter Mold", 0x0B000041, 0x0001000B, 0x10A0, 100, 40, 1,
     'm', "16d8", "21 5 1d6", 10, 10},
    {12, 26, "Giant Red Centipede", 0x00000240, 0x00000000, 0x0082, 500, 24, 2,
     'c', "3d8", "1 2 1d2|14 4 1d2", 10, 0},
    {5, 36, "Creeping Gold Coins", 0x0E000300, 0x00000000, 0x0002, 100, 32, 0,
     '$', "18d8", "1 2 2d5|14 8 3d5", 10, 0},
    {8, 14, "Giant Fruit Fly", 0x00A00308, 0x00000000, 0x0062, 500, 3, 2, 'F',
     "2d2", "1 2 1d2", 10, 0},
    {15, 85, "Swirling Blue Vapor", 0x00800308, 0x80C80001, 0x1000, 1, 20, 2,
     'v', "5d8", "7 5 2d4", 10, 0},
    {20, 20, "Demon Larva", 0x00200308, 0x00010008, 0x0406, 20, 10, 0, 'w',
     "5d6", "14 12 1d4", 10, 0},
    {20, 5, "Nymph", 0x13120210, 0x000004AA, 0x1000, 500, 30, 2, 'N', "8d8",
     "13 5 0d0", 10, 0},
    {20, 12, "Siren", 0x06120202, 0x00018A43, 0x10F0, 400, 35, 1, 'p', "10d8",
     "18 5 1d1|1 1 2d3", 10, 0},
    {20, 32, "Brigand", 0x13020200, 0x00000000, 0x2030, 100, 35, 1, 'p', "9d8",
     "1 1 2d4|13 5 0d0", 10, 0},
    {5, 25, "Alligator", 0x00000310, 0x00000000, 0x2022, 150, 150, 1, 'C',
     "25d8", "1 2 3d6", 10, 0},
    {6, 10, "Evil-Looking Peasant", 0x19000000, 0x00010486, 0x10F0, 50, 100, 1,
     'p', "10d6", "1 1 6-2d2", 10, 0},
    {2, 20, "Giant Anemone", 0x14400051, 0x00000000, 0x00B2, 5000, 75, 0, 'A',
     "10d8", "11 5 1d8|14 4 4d4", 11, 0},
    {20, 24, "Orc Zombie", 0x00020100, 0x00000000, 0x102E, 250, 30, 1, 'z',
     "11d8", "1 1 1d4|1 1 1d4", 11, 0},
    {20, 36, "Orc Warrior", 0x0F020200, 0x00000000, 0x2036, 250, 34, 1, 'o',
     "11d8", "1 1 2d6", 11, 0},
    {18, 10, "Nasty little Gnome", 0x0B020200, 0x000020B5, 0x2030, 10, 32, 1,
     'p', "4d8", "1 1 1d5", 11, 0},
    {20, 38, "Hobgoblin", 0x0F020200, 0x00000000, 0x2036, 300, 38, 1, 'H',
     "12d8", "1 1 1d10", 11, 0},
    {10, 30, "Cockatrice", 0x00000042, 0x08000002, 0x1026, 250, 75, 1, 'c',
     "10d8", "1 33 0d0|1 34 1d1|26 7 7d2", 11, 0},
    {8, 10, "Unholy Pirhana", 0x00200050, 0x00000000, 0x00F4, 0, 4, 2, 'f',
     "2d8", "1 2 2-1d6", 12, 0},
    {10, 50, "Water Moccasin", 0x00000210, 0x00000000, 0x00B2, 100, 75, 2, 'R',
     "10d8", "1 16 1d8|14 2 4d4", 12, 0},
    {20, 32, "Black Mamba", 0x00000244, 0x00000000, 0x00B0, 1, 40, 2, 'R',
     "10d8", "14 2 4d4", 12, 0},
    {2, 1, "Grape Jelly", 0x0B000041, 0x0001000B, 0x01A0, 999, 60, 1, 'J',
     "52d8", "19 5 5d8", 12, 0},
    {18, 24, "Master Yeek", 0x07020240, 0x00008018, 0x2030, 100, 28, 1, 'y',
     "5d8", "1 1 1d8", 12, 0},
    {20, 22, "Priest", 0x13020240, 0x00000285, 0x2030, 400, 36, 1, 'p', "7d8",
     "1 1 2d3", 12, 0},
    {20, 22, "Bard", 0x13020200, 0x00000285, 0x2030, 400, 45, 1, 'p', "9d8",
     "1 1 2d5", 12, 0},
    {20, 22, "Monk", 0x13020200, 0x00000000, 0x2030, 100, 36, 1, 'p', "9d8",
     "1 1 2-2d5", 12, 0},
    {4, 60, "Animated Sword", 0x008A0300, 0x00000000, 0x5000, 10, 45, 2, '|',
     "4d8", "1 1 2d4", 12, 0},
    {40, 90, "Swirling Green Vapor", 0x00800308, 0x80FE0001, 0x5000, 1, 40, 2,
     'v', "7d8", "14 5 2d4", 12, 0},
    {12, 18, "Giant Clear Ant", 0x00010240, 0x00000000, 0x0102, 600, 24, 1, 'c',
     "3d7", "1 2 1d4", 12, 0},
    {12, 20, "Air Spirit", 0x00830308, 0x00000000, 0x0010, 200, 40, 3, 'E',
     "5d8", "1 1 1d3", 12, 0},
    {20, 30, "Skeleton Human", 0x00020300, 0x00000000, 0x100C, 300, 38, 1, 's',
     "12d8", "1 1 1d8", 12, 0},
    {20, 24, "Human Zombie", 0x00020300, 0x00000000, 0x102E, 200, 34, 1, 'z',
     "11d8", "1 1 1d4|1 1 1d4", 12, 0},
    {6, 20, "Moaning Spirit", 0x0F950302, 0x0001002E, 0x100C, 300, 44, 1, 'G',
     "4d8", "4 10 0d0|15 5 1d8", 12, 0},
    {10, 40, "Demonic Spirit", 0x0F950302, 0x00010008, 0x1404, 250, 35, 1, 'G',
     "4d7", "3 26 0d0| 25 5 1d8", 12, 0},
    {20, 34, "Swordsman", 0x13020200, 0x00000000, 0x2030, 999, 40, 1, 'p',
     "11d8", "1 1 3d5", 12, 0},
    {8, 75, "Vorpal Bunny", 0x18000240, 0x00000000, 0x7000, 0, 100, 3, 'r',
     "12d8", "1 31 3-1d4", 13, 0},
    {8, 10, "Kracken", 0x00000050, 0x00000000, 0x90F2, 0, 4, 2, 'R', "10d8",
     "1 2 2-2d6", 13, 0},
    {10, 40, "Killer Brown Beetle", 0x00000242, 0x00000000, 0x0002, 300, 38, 1,
     'K', "1d8", "1 2 3d4", 13, 0},
    {20, 32, "Ogre", 0x07020200, 0x00000000, 0x2036, 300, 42, 1, 'o', "13d8",
     "1 1 2d8", 13, 0},
    {12, 20, "Giant Red Speckled Frog", 0x00000312, 0x00000000, 0x00A2, 300, 32,
     1, 'a', "6d8", "1 2 3d4", 13, 0},
    {20, 10, "Magic User", 0x13020200, 0x00002413, 0x2030, 100, 35, 1, 'p',
     "7d8", "1 1 2d2", 13, 0},
    {20, 10, "Ranger", 0x13020200, 0x00000094, 0x2030, 80, 40, 1, 'p', "11d8",
     "1 1 3d3", 13, 0},
    {20, 36, "Black Orc", 0x0B020200, 0x00000000, 0x2036, 200, 40, 1, 'o',
     "12d8", "1 1 3d4", 13, 0},
    {12, 20, "Giant Long-Eared Bat", 0x00800306, 0x00000000, 0x2160, 200, 20, 3,
     'b', "5d8", "1 2 1d4|1 3 1d2|1 3 1d2", 13, 0},
    {8, 4, "Giant Gnat", 0x00A00308, 0x00000000, 0x0062, 100, 1, 3, 'F', "1d2",
     "1 2 1d1", 13, 0},
    {12, 45, "Killer Green Beetle", 0x00000244, 0x00000000, 0x0002, 300, 46, 1,
     'K', "16d8", "1 2 4d4", 14, 0},
    {8, 25, "Giant Flea", 0x00200248, 0x00000000, 0x0062, 100, 1, 2, 'F', "2d2",
     "1 2 1d2", 14, 0},
    {20, 20, "Giant White Dragon Fly", 0x00800304, 0x0040000A, 0x0060, 500, 54,
     1, 'F', "5d8", "7 2 1d6", 14, 0},
    {20, 36, "Hill Giant", 0x07020200, 0x00000000, 0x2034, 500, 52, 1, 'P',
     "16d8", "1 1 3d6", 14, 0},
    {20, 34, "Skeleton Hobgoblin", 0x00020300, 0x00000000, 0x100C, 300, 46, 1,
     's', "13d8", "1 1 2d5", 14, 0},
    {12, 10, "Flesh Golem", 0x00020200, 0x00000000, 0x11B0, 100, 48, 1, 'g',
     "12d8", "1 1 1d6|1 1 1d6", 14, 0},
    {12, 20, "White Dragon Bat", 0x00800304, 0x00400004, 0x2150, 500, 40, 3,
     'b', "2d6", "7 2 1d3", 14, 0},
    {6, 7, "Giant Black Lice", 0x00200244, 0x00000000, 0x01F2, 100, 1, 2, 'l',
     "1d1", "1 2 1d2", 14, 0},
    {12, 75, "Anaconda", 0x00000300, 0x00000000, 0x50F0, 50, 275, 1, 'R',
     "18d8", "1 16 2-3d8", 15, 0},
    {20, 50, "Guardian Naga", 0x17100302, 0x00000000, 0x20E6, 1200, 60, 1, 'n',
     "24d8", "1 16 2d8|1 2 1d8", 15, 0},
    {12, 22, "Giant Grey Bat", 0x00800304, 0x00000000, 0x2160, 150, 22, 3, 'b',
     "4d8", "1 2 1d6|1 3 1d2|1 3 1d2", 15, 0},
    {10, 30, "Giant Clear Centipede", 0x00010240, 0x00000000, 0x0002, 300, 30,
     1, 'c', "5d8", "1 2 2d4|1 4 2d4", 15, 0},
    {12, 48, "Giant Yellow Tick", 0x00000242, 0x00000000, 0x0022, 200, 48, 0,
     't', "20d8", "14 2 3d9", 15, 0},
    {12, 24, "Giant Ebony Ant", 0x00200240, 0x00000000, 0x0002, 600, 3, 1, 'c',
     "3d4", "1 2 2d3", 15, 0},
    {20, 38, "Frost Giant", 0x07020200, 0x00000000, 0x0024, 500, 54, 1, 'P',
     "17d8", "7 1 3d6", 15, 0},
    {20, 36, "Ettin", 0x07020200, 0x00000000, 0x2034, 500, 65, 1, 'P', "15d8",
     "1 1 3d4|1 1 3d4", 15, 0},
    {4, 20, "Statue", 0x00000041, 0x00000000, 0x0200, 200, 45, 1, '~', "17d8",
     "1 1 2d8", 15, 0},
    {40, 95, "Swirling White Vapor", 0x00800320, 0x8FFE0001, 0x5000, 1, 50, 2,
     'v', "8d8", "11 5 1d6| 23 5 1d6", 15, 0},
    {12, 20, "Clay Golem", 0x00020140, 0x00000000, 0x1200, 100, 50, 1, 'g',
     "14d8", "1 1 1d8|1 1 1d8", 15, 0},
    {7, 12, "Huge White Bat", 0x00A00304, 0x00000000, 0x2160, 400, 3, 2, 'b',
     "3d8", "1 2 1d6", 15, 0},
    {12, 18, "Giant Tan Bat", 0x00800304, 0x00000000, 0x2160, 400, 18, 2, 'b',
     "3d8", "4 2 1d2|1 3 1d1|1 3 1d1", 15, 0},
    {2, 15, "Violet Mold", 0x0B000041, 0x00010009, 0x10A0, 700, 50, 1, 'm',
     "17d8", "11 1 1d2", 15, 0},
    {5, 20, "Giant Tarantula", 0x00000100, 0x00000000, 0x0032, 200, 110, 1, 'x',
     "20d8", "11 2 1d2|1 2 5d6", 15, 0},
    {15, 45, "Quickling", 0x13000200, 0x00009006, 0x3044, 15, 150, 4, 'q',
     "15d5", "14 1 2-1d3", 15, 0},
    {10, 30, "Red-Orange Faerie Dragon", 0x19820302, 0x00008C96, 0x4001, 40, 50,
     2, 'F', "5d8", "3 3 2-1d4", 16, 0},
    {2, 3, "Stone Fish", 0x00410051, 0x00000000, 0x0092, 500, 35, 0, 'f', "4d8",
     "26 4 1d2|14 4 5d8", 16, 0},
    {20, 20, "Umber Hulk", 0x00020300, 0x00000000, 0x2126, 100, 75, 1, 'U',
     "20d8", "3 7 0d0|1 1 2-1d6|1 2 2d6", 16, 0},
    {12, 18, "Gelatinous Cube", 0x2F180142, 0x00000000, 0x00A2, 1, 36, 0, 'C',
     "45d8", "6 5 1d10", 16, 0},
    {8, 16, "Giant Black Rat", 0x00200306, 0x00000000, 0x2070, 200, 3, 1, 'r',
     "3d4", "14 2 1d5", 16, 0},
    {8, 50, "Giant Jelly Fish", 0x00000050, 0x00000000, 0x00F0, 0, 300, 2, 'f',
     "13d8", "4 11 2-2d6|4 27 1d20", 16, 0},
    {20, 20, "Giant Green Dragon Fly", 0x00800304, 0x0010000A, 0x0070, 500, 58,
     1, 'F', "5d8", "14 2 1d6", 16, 0},
    {20, 40, "Fire Giant", 0x07020200, 0x00000000, 0x2014, 500, 62, 1, 'P',
     "20d8", "5 1 3d7", 16, 0},
    {12, 22, "Green Dragon Bat", 0x00800304, 0x00100004, 0x2150, 500, 44, 3,
     'b', "2d7", "14 2 1d3", 16, 0},
    {20, 30, "Quasit", 0x11030202, 0x000010FA, 0x0004, 200, 48, 1, 'q', "5d8",
     "15 2 1d6|1 3 1d3|1 3 1d3", 16, 0},
    {20, 40, "Troll", 0x07020300, 0x00000000, 0xA026, 400, 74, 1, 'T', "17d8",
     "1 1 2-1d4|1 2 1d6", 17, 0},
    {6, 30, "Giant Water Spider", 0x00400210, 0x00000000, 0x0002, 8, 100, 2,
     'x', "12d8", "1 30 5d4|11 2 1d3", 17, 0},
    {12, 28, "Water Spirit", 0x00000152, 0x00000000, 0x0020, 400, 58, 0, 'E',
     "8d8", "1 1 2d4", 17, 0},
    {14, 44, "Giant Brown Scorpion", 0x00000242, 0x00000000, 0x0002, 200, 62, 1,
     'S', "11d8", "1 2 2d4|2 4 1d7", 17, 0},
    {10, 40, "Earth Spirit", 0x00000142, 0x00000000, 0x0200, 500, 64, 1, 'E',
     "13d8", "1 1 1d8|1 1 1d8", 17, 0},
    {6, 25, "Giant Black Widow", 0x00000200, 0x00000000, 0x0032, 110, 150, 1,
     'x', "12d8", "1 2 1d6|27 2 5d8", 18, 0},
    {20, 30, "Fire Spirit", 0x00000140, 0x00000000, 0x2010, 200, 66, 2, 'E',
     "10d8", "5 1 2d6", 18, 0},
    {20, 42, "Urik-Hai Orc", 0x0B020200, 0x00000000, 0x2036, 200, 68, 1, 'o',
     "14d8", "1 1 3d5", 18, 0},
    {20, 24, "Imp", 0x11030202, 0x010010FA, 0x0404, 150, 75, 1, 'q', "7d8",
     "15 2 1d6|2 3 2-1d6|16 4 1d3", 18, 0},
    {20, 40, "Stone Giant", 0x07020300, 0x00000000, 0x2204, 500, 80, 1, 'P',
     "22d8", "1 1 3d8", 18, 0},
    {15, 30, "Black Hag", 0x09100302, 0x00008086, 0x2066, 300, 150, 1, 'p',
     "20d4", "1 6 2d6|10 9 2d6|25 19 1d1", 18, 0},
    {10, 20, "Phase Spider", 0x00060300, 0x00000000, 0x8000, 110, 175, 1, 'x',
     "20d8", "1 2 6d6", 18, 0},
    {12, 75, "Stone Golem", 0x00020300, 0x00000000, 0x1200, 100, 100, 0, 'g',
     "28d8", "1 1 2-1d10", 19, 0},
    {15, 10, "Grey Ooze", 0x071A0248, 0x00000000, 0x00A2, 1, 40, 1, 'O', "6d8",
     "7 5 2d6", 19, 0},
    {15, 15, "Disenchanter Ooze", 0x071A0248, 0x00000000, 0x00A2, 1, 50, 1, 'O',
     "6d8", "21 5 0d0", 19, 15},
    {8, 20, "Giant Spotted Rat", 0x00200302, 0x00000000, 0x2070, 200, 3, 1, 'r',
     "4d3", "14 2 1d5", 19, 0},
    {20, 24, "Mummified Kobold", 0x0B020300, 0x00000000, 0x102C, 750, 46, 1,
     'M', "13d8", "1 1 1d6|1 1 1d6", 19, 0},
    {14, 46, "Killer Black Beetle", 0x00000242, 0x00000000, 0x0002, 300, 75, 1,
     'K', "18d8", "1 2 4d5", 19, 0},
    {2, 16, "Red Mold", 0x0B000041, 0x00000000, 0x30A0, 700, 64, 1, 'm', "17d8",
     "5 5 4d4", 19, 0},
    {10, 1, "Quythulg", 0x00010300, 0x00002010, 0x5000, 0, 200, 1, 'Q', "4d8",
     "99 0 0d0", 20, 0},
    {15, 40, "Gargoyle", 0x17800000, 0x00008088, 0x9606, 200, 200, 1, 'g',
     "25d8", "4 1 1d4|1 3 2-4d4", 20, 0},
    {30, 65, "<gp>'s Ghost", 0x14870300, 0x00000000, 0x500C, 50, 210, 2, 'G',
     "15d8", "1 1 2d8|4 5 2d6", 20, 0},
    {20, 30, "Winter Wolf", 0x00000304, 0x00000000, 0x1020, 10, 200, 2, 'j',
     "10d8", "1 1 2d6| 7 8 3d6", 20, 0},
    {2, 50, "Trapper", 0x00010341, 0x00000000, 0x1000, 500, 125, 1, '.', "20d8",
     "11 16 4d4", 20, 0},
    {12, 24, "Giant Red Bat", 0x00800302, 0x00000000, 0x2060, 200, 40, 2, 'b',
     "5d8", "1 2 1d7|1 3 2-1d3", 20, 0},
    {40, 95, "Swirling Clear Vapor", 0x00800308, 0x8FFE0001, 0x5000, 1, 90, 2,
     'v', "8d8", "21 5 1d6", 20, 0},
    {20, 50, "Kobold Chieftain", 0x13120300, 0x0000B145, 0x3034, 300, 150, 1,
     'k', "18d8", "1 1 4d4|1 1 4d4", 20, 0},
    {20, 50, "King Yeek", 0x13120300, 0x00000324, 0x3000, 300, 150, 1, 'y',
     "22d8", "1 1 4d3|1 1 4d3", 20, 0},
    {10, 45, "Zombie Dragon", 0x00020300, 0x00009544, 0x100C, 700, 120, 1, 'z',
     "20d8", "1 3 2d3|1 3 2d3|1 2 3d4", 20, 15},
    {20, 50, "Hydra", 0x22020302, 0x00001905, 0x3005, 1, 150, 1, 'd', "20d8",
     "1 3 2d3|1 3 2d3|1 2 2-3d3", 20, 0},
    {8, 25, "Disenchanter Icky-Thing", 0x05300244, 0x0001000A, 0x1000, 500, 10,
     0, 'i', "8d10", "21 12 2d2", 20, 15},
    {20, 22, "Giant Black Dragon Fly", 0x00800304, 0x00200009, 0x0072, 500, 58,
     1, 'F', "4d8", "10 2 1d6", 20, 0},
    {20, 44, "Cloud Giant", 0x07020200, 0x00000000, 0x2134, 500, 125, 1, 'P',
     "24d8", "8 1 3d8", 20, 0},
    {12, 24, "Black Dragon Bat", 0x00800304, 0x00200004, 0x2150, 500, 50, 3,
     'b', "2d8", "6 2 1d3", 21, 0},
    {30, 60, "Immature Dragon", 0x12820302, 0x00000000, 0x4001, 500, 180, 1,
     'd', "12d8", "1 6 2-1d8|1 2 3d4", 21, 70},
    {12, 26, "Blue Dragon Bat", 0x00800304, 0x00080004, 0x2150, 500, 54, 3, 'b',
     "3d6", "8 2 1d3", 21, 0},
    {20, 28, "Mummified Orc", 0x0B020300, 0x00000000, 0x102C, 750, 56, 1, 'M',
     "14d8", "1 1 2d4|1 1 2d4", 21, 0},
    {12, 48, "Killer Boring Beetle", 0x00000240, 0x00000000, 0x0002, 300, 70, 1,
     'K', "18d8", "1 2 4d5", 21, 0},
    {12, 50, "Killer Stag Beetle", 0x00000242, 0x00000000, 0x0002, 300, 80, 1,
     'K', "20d8", "1 2 3d4|1 1 1d12", 22, 0},
    {2, 18, "Black Mold", 0x0B000041, 0x00000000, 0x10A0, 500, 68, 1, 'm',
     "15d8", "1 1 4d3", 22, 0},
    {12, 99, "Iron Golem", 0x00020300, 0x00000000, 0x1080, 100, 160, -1, 'g',
     "80d8", "1 1 1d12|1 1 1d12", 22, 0},
    {12, 38, "Giant Yellow Scorpion", 0x00000242, 0x00000000, 0x0002, 200, 60,
     1, 'S', "12d8", "1 2 1d8|14 4 2d5", 22, 0},
    {15, 5, "Green Ooze", 0x00200041, 0x00000000, 0x00B2, 1, 6, 0, 'O', "4d8",
     "6 5 2d3", 22, 0},
    {10, 6, "Green Slime", 0x003A0044, 0x0001000B, 0x0192, 1, 7, -1, 'O', "8d8",
     "9 5 2d8", 23, 0},
    {10, 6, "Black Ooze", 0x003A0044, 0x0001000B, 0x0192, 1, 7, -1, 'O', "6d8",
     "9 5 2d6", 23, 0},
    {20, 40, "Warrior", 0x13120200, 0x00000000, 0x2030, 400, 60, 1, 'p', "15d8",
     "1 1 3d5", 23, 0},
    {12, 28, "Red Dragon Bat", 0x00800004, 0x00800004, 0x2150, 500, 60, 3, 'b',
     "3d8", "5 2 1d3", 23, 0},
    {15, 50, "Killer Blue Beetle", 0x00000242, 0x00000000, 0x0002, 300, 85, 1,
     'K', "20d8", "1 2 4d5", 23, 0},
    {15, 38, "Giant Silver Ant", 0x00000242, 0x00000000, 0x0002, 600, 45, 1,
     'c', "6d8", "6 2 4d4", 23, 0},
    {2, 18, "Crimson Mold", 0x0B000041, 0x00000000, 0x10A0, 500, 65, 1, 'm',
     "16d8", "1 1 1d3|4 5 0d0", 23, 0},
    {20, 35, "Red Hag", 0x09100202, 0x00000295, 0x2066, 250, 250, 1, 'p',
     "20d6", "1 6 3d4|10 9 3d4|25 19 1d1", 23, 0},
    {10, 35, "Orange Faerie Dragon", 0x21820302, 0x00000E96, 0x4001, 30, 100, 2,
     'F', "7d8", "3 3 2-1d6", 24, 0},
    {20, 30, "Forest Wight", 0x0F000202, 0x0000100F, 0x112E, 300, 140, 1, 'W',
     "12d8", "1 1 2-1d6|19 5 12d8", 24, 0},
    {20, 20, "Berzerker", 0x07020200, 0x00000000, 0x2030, 100, 65, 1, 'p',
     "15d8", "1 1 1d8|1 1 1d8", 24, 0},
    {20, 34, "Mummified Human", 0x0B020200, 0x00000000, 0x102C, 600, 70, 1, 'M',
     "17d8", "1 1 2d4|1 1 2d4", 24, 0},
    {20, 24, "Banshee", 0x0F950306, 0x0001002F, 0x100C, 100, 60, 2, 'G', "6d8",
     "4 10 0d0|19 5 14d8", 24, 0},
    {20, 40, "Giant Troll", 0x0F020200, 0x00000000, 0xA026, 500, 105, 1, 'T',
     "19d8", "1 1 2-1d6|1 2 3d4", 25, 0},
    {12, 50, "Giant Brown Tick", 0x00000144, 0x00000000, 0x0022, 200, 70, 0,
     't', "18d8", "14 2 1d10|10 4 1d1", 25, 0},
    {20, 80, "Hobgoblin Chief", 0x12020300, 0x00000888, 0x3004, 300, 120, 3,
     'H', "20d8", "1 1 4d4", 25, 0},
    {20, 10, "Nymph Princess", 0x15130210, 0x000084F4, 0x3000, 1000, 100, 3,
     'N', "20d8", "13 5 0d0|12 5 0d0", 25, 20},
    {8, 12, "Mimic", 0x06000041, 0x00000000, 0x3020, 500, 100, 3, '&', "10d10",
     "1 16 3d3|1 1 3-2d4", 25, 0},
    {15, 50, "Killer Red Beetle", 0x00000240, 0x00000000, 0x0002, 300, 85, 1,
     'K', "20d8", "2 2 4d4", 25, 0},
    {2, 50, "Wooden Mold", 0x00000041, 0x00000000, 0x10A0, 999, 100, 1, 'm',
     "25d8", "14 8 2d6", 25, 0},
    {20, 24, "Giant Blue Dragon Fly", 0x00800310, 0x00080009, 0x0030, 500, 75,
     1, 'F', "6d8", "1 2 1d6", 25, 0},
    {10, 15, "Hippo", 0x00000210, 0x00000000, 0x20F2, 500, 250, 1, 'H', "50d8",
     "1 17 2-2d10|1 2 2d8", 25, 0},
    {15, 45, "Orc Lord", 0x13000300, 0x00000000, 0x4000, 40, 400, 2, 'o',
     "15d8", "1 1 5d4", 25, 0},
    {10, 40, "Giant Grey Ant Lion", 0x00080242, 0x00000000, 0x0032, 400, 90, 1,
     'A', "19d8", "1 2 2d12", 26, 0},
    {14, 24, "Disenchanter Bat", 0x00800304, 0x00000000, 0x2060, 1, 75, 3, 'b',
     "4d8", "21 1 0d0", 26, 20},
    {14, 54, "Giant Fire Tick", 0x00000142, 0x00000000, 0x2012, 200, 90, 1, 't',
     "16d8", "5 9 3d7", 26, 0},
    {14, 40, "Hell Hound", 0x00000310, 0x0080000F, 0x3414, 200, 120, 1, 'j',
     "14d8", "5 8 3d5|1 2 2d5", 26, 0},
    {20, 40, "White Wraith", 0x0F020302, 0x00000000, 0x112E, 100, 165, 1, 'W',
     "15d8", "1 1 2-1d6|19 5 15d8", 26, 0},
    {12, 50, "Giant Black Scorpion", 0x00000240, 0x00000000, 0x0002, 200, 85, 1,
     'S', "13d8", "1 2 1d10|14 4 2d5", 26, 0},
    {10, 14, "Clear Ooze", 0x000B0148, 0x00000000, 0x00B2, 1, 12, 1, 'O', "4d8",
     "3 5 1d8", 26, 0},
    {14, 45, "Killer Fire Beetle", 0x00000144, 0x00000000, 0x2012, 300, 95, 1,
     'K', "13d8", "1 2 3d4|5 9 4d5", 27, 0},
    {20, 45, "Gluhtyuq", 0x17010300, 0x04000001, 0x0000, 100, 175, 1, 'Q',
     "2d6", "99 0 0d0", 27, 0},
    {20, 45, "Vampire", 0x17000300, 0x00001209, 0x112E, 100, 175, 1, 'V',
     "20d8", "1 1 2-1d6|19 30 18d8", 27, 0},
    {20, 24, "Giant Red Dragon Fly", 0x00800304, 0x00800008, 0x2050, 500, 75, 1,
     'F', "7d8", "4 2 1d6", 27, 0},
    {2, 24, "Shimmering Mold", 0x0B000041, 0x00000000, 0x10A0, 100, 180, 1, 'm',
     "32d8", "8 5 5d4", 27, 0},
    {20, 60, "Black Knight", 0x17020200, 0x0000010F, 0x2030, 100, 140, 1, 'p',
     "25d8", "1 1 5d5", 28, 0},
    {20, 30, "Mage", 0x13020200, 0x00002C73, 0x2030, 100, 150, 1, 'p', "10d8",
     "1 1 2d5", 28, 0},
    {20, 50, "Master Bard", 0x13020200, 0x13001A93, 0x2030, 85, 160, 1, 'p',
     "20d8", "1 1 4d4", 28, 0},
    {20, 30, "Druid", 0x13020200, 0x13080503, 0x2030, 100, 160, 1, 'p', "16d8",
     "1 1 2d6", 28, 0},
    {20, 50, "Master Monk", 0x13020200, 0x00000000, 0x2030, 85, 160, 2, 'p',
     "20d8", "1 1 2-3d3", 28, 0},
    {20, 46, "Ice Troll", 0x0F020200, 0x00000000, 0x8026, 500, 190, 1, 'T',
     "22d8", "1 1 2-1d5|7 2 3d6", 28, 0},
    {20, 35, "Night Hag", 0x17100302, 0x00000394, 0x2066, 250, 250, 1, 'p',
     "30d8", "1 6 3d6|10 9 4d6|25 19 1d2", 28, 20},
    {8, 50, "Demon Sword", 0x00880310, 0x80FA0001, 0x5404, 700, 220, 2, '|',
     "10d9", "1 1 3d6|19 10 10d8", 28, 0},
    {14, 65, "Giant Purple Worm", 0x00000242, 0x00000000, 0x2030, 300, 400, 1,
     'w', "65d8", "1 1 1d8|6 2 2d8|14 4 1d8", 29, 0},
    {20, 50, "Young Blue Dragon", 0x1F000202, 0x0008100B, 0x2005, 700, 300, 1,
     'd', "33d8", "1 3 2-1d4|1 2 1d6", 29, 25},
    {20, 50, "Young White Dragon", 0x1F000202, 0x0040100B, 0x2005, 700, 275, 1,
     'd', "32d8", "1 3 2-1d4|1 2 1d6", 29, 25},
    {20, 50, "Young Green Dragon", 0x1F000202, 0x0010100B, 0x2005, 700, 290, 1,
     'd', "32d8", "1 3 2-1d4|1 2 1d6", 29, 25},
    {14, 30, "Giant Fire Bat", 0x00800310, 0x00000000, 0x2050, 100, 85, 2, 'b',
     "5d8", "5 2 3d6|1 3 2-1d4", 29, 0},
    {8, 24, "Giant Glowing Rat", 0x00200302, 0x00000000, 0x2070, 200, 4, 1, 'r',
     "3d3", "8 2 2d6", 29, 0},
    {8, 15, "Hammerhead Shark", 0x00000050, 0x00000000, 0x6000, 100, 600, 2,
     'S', "75d6", "1 2 3-4d4|1 25 10d4;", 30, 0},
    {20, 55, "Skeleton Troll", 0x00020300, 0x00000000, 0x500C, 400, 225, 1, 's',
     "14d8", "1 1 2-1d6|1 2 3d4", 30, 0},
    {15, 34, "Giant Lightning Bat", 0x00800302, 0x00000000, 0x2042, 100, 80, 2,
     'b', "8d8", "8 2 3d8|1 3 2-1d5", 30, 0},
    {10, 40, "Giant Static Ant", 0x00000242, 0x00000000, 0x0002, 600, 80, 1,
     'c', "8d8", "8 2 5d5", 30, 0},
    {30, 80, "Swirling Black Vapor", 0x00800308, 0x8FFE0001, 0xD100, 1, 350, 3,
     'v', "11d8", "19 5 10d8", 30, 0},
    {20, 40, "Lesser Demon", 0x12120300, 0x0280509A, 0xE414, 1000, 325, 1, 'B',
     "25d8", "5 1 3d3", 30, 25},
    {20, 35, "Grave Wight", 0x0F020308, 0x0000190A, 0x512E, 300, 325, 1, 'W',
     "12d8", "1 1 2-1d7|19 5 20d8", 30, 0},
    {14, 55, "Killer Slicer Beetle", 0x00000242, 0x00000000, 0x0012, 300, 200,
     1, 'K', "22d8", "1 2 5d8", 30, 0},
    {12, 45, "Giant White Ant Lion", 0x00080042, 0x00000000, 0x0022, 400, 175,
     1, 'A', "20d8", "7 2 3d10", 30, 0},
    {15, 4, "Tunneling Worm Mass", 0x00260344, 0x00000000, 0x21B2, 30, 7, 0,
     'w', "4d8", "9 12 1d3", 30, 0},
    {20, 30, "Ghost", 0x17950308, 0x0001002F, 0x500C, 100, 350, 2, 'G', "13d8",
     "4 7 0d0|19 5 22d8|17 3 1d10", 31, 0},
    {14, 45, "Giant Black Ant Lion", 0x00080042, 0x00000000, 0x0032, 400, 170,
     1, 'A', "23d8", "1 2 2d12|6 9 3d6", 31, 0},
    {16, 60, "Death Watch Beetle", 0x00000042, 0x00000000, 0x0012, 300, 190, 1,
     'K', "25d8", "1 2 5d4|1 10 5d6", 31, 0},
    {20, 55, "Horned Demon", 0x0F020300, 0x00000000, 0x7504, 300, 350, 2, 'B',
     "12d8", "1 25 2-1d8|21 8 1d6 31", 31, 30},
    {20, 42, "Ogre Magi", 0x07020300, 0x0000A356, 0x403C, 300, 250, 1, 'o',
     "14d8", "1 1 3d6", 31, 30},
    {5, 30, "Crystal Ooze", 0x07390243, 0x00000000, 0x0092, 600, 8, -1, 'O',
     "12d8", "7 5 4d4", 31, 0},
    {10, 40, "Yellow Faerie Dragon", 0x31820302, 0x01000E93, 0x4001, 40, 250, 3,
     'F', "9d8", "3 3 2-1d8", 32, 0},
    {20, 48, "Two-Headed Troll", 0x0F020300, 0x00000000, 0xE026, 500, 315, 1,
     'T', "14d8", "1 1 2-1d8|1 2 2-1d6", 32, 0},
    {20, 40, "Ice Demon", 0x0F020300, 0x00010106, 0x7444, 450, 350, 1, 'B',
     "20d8", "7 1 4d6", 32, 0},
    {20, 46, "Invisible Stalker", 0x00830308, 0x00000000, 0x0000, 200, 200, 3,
     'E', "19d8", "1 1 1d6", 32, 0},
    {16, 40, "Giant Hunter Ant", 0x00000240, 0x00000000, 0x0002, 10, 150, 1,
     'c', "12d8", "1 2 4d8", 32, 0},
    {20, 65, "Ninja", 0x0F020200, 0x00000000, 0x6030, 100, 300, 1, 'p', "15d8",
     "14 1 3d4|2 1 3d4", 32, 0},
    {5, 20, "Brontosaurus", 0x000A0312, 0x00000000, 0x6012, 250, 2000, 1, 'D',
     "500d8", "1 17 4-8d8", 32, 0},
    {20, 40, "Barrow Wight", 0x0F020302, 0x00001308, 0x512E, 100, 375, 1, 'W',
     "13d8", "1 1 2-1d8|19 5 26d8", 33, 0},
    {20, 48, "Skeleton 2-Headed Troll", 0x00020300, 0x00000000, 0x500C, 200,
     325, 1, 's', "20d8", "1 1 2-1d9|1 2 2-1d5", 33, 0},
    {12, 36, "Water Elemental", 0x00000212, 0x00000000, 0x0020, 500, 325, 2,
     'E', "25d8", "1 1 1d10|1 1 1d10", 33, 0},
    {16, 40, "Fire Elemental", 0x000A0144, 0x00000000, 0x2010, 700, 350, 1, 'E',
     "25d8", "5 1 4d6", 33, 0},
    {20, 50, "Lich", 0x1F020300, 0x00019F75, 0x500C, 600, 750, 1, 'L', "25d8",
     "15 5 2d8|19 5 30d8|24 5 0d0", 34, 40},
    {20, 55, "Master Vampire", 0x17000300, 0x00001307, 0x512E, 100, 700, 1, 'V',
     "23d8", "1 1 2-1d6|19 30 32d8", 34, 40},
    {20, 56, "Spirit Troll", 0x00040300, 0x00000000, 0x402E, 100, 425, 1, 'T',
     "15d8", "1 3 2-1d5|1 2 1d6", 34, 0},
    {12, 50, "Giant Red Scorpion", 0x00000242, 0x00000000, 0x0002, 400, 275, 2,
     'S', "18d8", "1 2 1d6|14 4 1d4", 34, 0},
    {10, 60, "Earth Elemental", 0x001A0140, 0x00000000, 0x0200, 900, 375, 1,
     'E', "30d8", "1 1 4d6|1 1 4d6", 34, 0},
    {4, 65, "Giant Remora", 0x00000050, 0x00000C47, 0xE002, 50, 1500, 2, 'R',
     "250d4", "2 30 2-4d5|15 30 2-3d6", 35, 0},
    {20, 55, "Young Black Dragon", 0x1F000202, 0x0020100B, 0x6005, 500, 600, 1,
     'd', "32d8", "1 3 2-1d5|1 2 1d6", 35, 40},
    {20, 60, "Young Red Dragon", 0x1F000102, 0x0080100A, 0x6015, 500, 650, 1,
     'd', "36d8", "1 3 2-1d8|1 2 2d8", 35, 40},
    {20, 40, "Necromancer", 0x13020200, 0x00005762, 0x6030, 100, 600, 1, 'p',
     "17d8", "1 1 2d6", 35, 50},
    {20, 50, "High Priest", 0x13020200, 0x02024322, 0x7004, 100, 600, 1, 'p',
     "25d12", "1 1 2d6", 35, 0},
    {20, 65, "Troll King", 0x17020300, 0x00003365, 0xF004, 200, 650, 2, 'T',
     "30d8", "1 3 3d3|1 3 3d3|1 2 5d5", 35, 0},
    {20, 50, "Heirophant Druid", 0x13020200, 0x00880522, 0x7000, 100, 1000, 2,
     'p', "50d8", "1 1 2d8|11 23 2d6", 35, 0},
    {20, 50, "Titan", 0x13020200, 0x23083763, 0x7004, 100, 550, 1, 'P', "40d8",
     "1 1 3d12|8 1 3d8", 35, 0},
    {20, 50, "Succubus", 0x13020200, 0x21011225, 0x3404, 100, 700, 1, 'p',
     "28d9", "18 5 3d3|3 24 4d4|19 2 38d8", 35, 50},
    {29, 38, "Mummified Troll", 0x0F020300, 0x00000000, 0x502C, 500, 400, 1,
     'M', "18d8", "1 1 2d6|1 1 2d6", 35, 0},
    {14, 48, "Giant Red Ant Lion", 0x00080142, 0x00000000, 0x0032, 400, 350, 2,
     'A', "23d8", "5 2 3d12", 35, 0},
    {20, 65, "Mature White Dragon", 0x2F000202, 0x0040100A, 0x4005, 700, 1000,
     2, 'd', "48d8", "1 3 2-1d8|1 2 2d8", 35, 50},
    {20, 60, "Nazgul", 0x12830000, 0x00020008, 0xD504, 1, 900, 2, 'Z', "38d8",
     "4 1 2d8|2 17 3d10", 35, 50},
    {25, 60, "Cerebus", 0x00000304, 0x00001048, 0x7002, 200, 800, 1, 'j',
     "26d8", "1 2 3-3d6|7 8 4d4|5 8 4d4|4 8 4d4", 35, 0},
    {9, 25, "Mako Shark", 0x00080050, 0x00000000, 0xC000, 10, 1000, 3, 'S',
     "100d5", "1 2 2-3d5", 35, 75},
    {20, 80, "Shadow Dragon", 0x23050300, 0x00035702, 0x510D, 25, 1250, 2, 'd',
     "45d8", "19 3 2-1d9|4 2 2d10", 35, 60},
    {20, 80, "Xorn", 0x00160300, 0x00000000, 0x4200, 100, 650, 1, 'X', "20d8",
     "1 1 3-1d6", 36, 0},
    {14, 50, "Giant Mottled Ant Lion", 0x00080242, 0x00000000, 0x0032, 400, 350,
     2, 'A', "24d8 ", "1 2 2d10", 36, 0},
    {20, 50, "Grey Wraith", 0x0F020302, 0x00011308, 0x512E, 100, 700, 1, 'W',
     "23d8", "1 1 2-1d10|19 5 34d8", 36, 0},
    {20, 55, "Young Multi-Hued Dragon", 0x7F000202, 0x00F81005, 0x6005, 500,
     1250, 1, 'd', "40d8", "1 3 2-1d9|1 2 2d10", 36, 60},
    {20, 75, "Mature Blue Dragon", 0x2F000202, 0x00081009, 0x6005, 400, 1200, 2,
     'd', "48d8", "1 3 1d8|1 3 1d8|1 2 2d10", 36, 60},
    {20, 60, "Major Demon", 0x12130300, 0x02815578, 0x3414, 800, 700, 2, 'B',
     "50d8", "5 3 4d4|5 3 4d4|4 2 2d2", 36, 60},
    {20, 70, "Mature Green Dragon", 0x1F000202, 0x0010100A, 0x6005, 700, 1100,
     2, 'd', "48d8", "1 3 1d4|1 3 1d4|1 2 1d6", 36, 60},
    {20, 75, "Pyrohydra", 0x230A0200, 0x00801103, 0x5012, 50, 2000, 2, 'd',
     "100d8", "1 3 2-3d4|1 2 3-4d4", 37, 0},
    {20, 65, "Vampiric Demon", 0x17000300, 0x02001307, 0xD40C, 85, 1400, 1, 'V',
     "40d8", "1 3 2d6| 1 3 2d6|19 2 38d8", 37, 65},
    {20, 60, "Demon Warrior", 0x0F020300, 0x00000000, 0x7504, 100, 400, 1, 'B',
     "20d8", "1 1 3d5|1 1 3d5|1 2 2d5", 37, 65},
    {16, 60, "Iridescent Beetle", 0x00000242, 0x00000000, 0x0012, 300, 850, 1,
     'K', "32d8", "1 2 4d6|1 1 1d12|11 7 0d0", 37, 0},
    {20, 65, "King Vampire", 0x17000300, 0x00001307, 0x512E, 100, 1000, 1, 'V',
     "38d8", "1 1 2-1d6|19 30 38d8", 37, 70},
    {20, 65, "King Lich", 0x1F020300, 0x00019F73, 0x500C, 500, 1400, 1, 'L',
     "52d8", "15 5 2d10|19 5 36d8|24 5 0d0", 37, 70},
    {20, 80, "Mature Red Dragon", 0x2F000302, 0x00801808, 0x6015, 300, 1400, 2,
     'd', "60d8", "1 3 2-1d10|1 2 2d12", 37, 80},
    {20, 55, "Mature Black Dragon", 0x2F000302, 0x00201009, 0x6005, 700, 1350,
     2, 'd', "58d8", "1 3 2-1d8|1 2 2d10", 37, 80},
    {20, 65, "Mature Multi-Hued Dragon", 0x7F000302, 0x00F81A05, 0x6005, 500,
     1650, 2, 'd', "80d8", "1 3 2-1d10|1 2 2d12", 38, 80},
    {20, 80, "Ancient White Dragon", 0x4F000300, 0x00401A08, 0x4005, 800, 1500,
     3, 'D', "88d8", "1 3 1d8|1 3 1d8|1 2 2d8", 38, 90},
    {20, 40, "Emperor Wight", 0x1B020302, 0x00001306, 0x512E, 100, 1600, 2, 'W',
     "48d8", "1 1 2-1d12|19 5 42d8", 38, 90},
    {20, 55, "Black Wraith", 0x1F020302, 0x00001307, 0x512E, 100, 1700, 1, 'W',
     "50d8", "1 1 2-1d12|19 5 44d8", 38, 100},
    {20, 40, "Beholder", 0x00820302, 0x8101B7C6, 0x7106, 100, 4000, 4, 'e',
     "60d8", "21 7 2d4", 38, 100},
    {40, 90, "Swirling Multi-Hued Vapor", 0x00800304, 0x80FFE001, 0xD000, 1,
     1000, 3, 'v', "20d8", "11 5 2d6|21 5 2d6|3 5 2d6|24 5 1d6", 38, 0},
    {30, 40, "Shadow Hag", 0x1B110302, 0x00010394, 0x4046, 200, 1650, 2, 'p',
     "40d6", "1 6 3d6|10 9 4d6|25 19 1d2", 38, 100},
    {20, 55, "Nether Wraith", 0x1F070302, 0x00005316, 0x512E, 100, 2100, 1, 'W',
     "58d8", "1 1 2-1d12|19 5 52d8", 39, 100},
    {20, 50, "Sorcerer", 0x13020300, 0x0200FF73, 0x6030, 100, 2150, 2, 'p',
     "30d8", "1 1 2d8", 39, 100},
    {20, 90, "Ancient Blue Dragon", 0x4F000300, 0x00081A08, 0x6005, 800, 2500,
     3, 'D', "87d8", "1 3 2-1d9|1 2 2d12", 39, 125},
    {20, 85, "Ancient Green Dragon", 0x4F000300, 0x00101A09, 0x6005, 700, 2400,
     3, 'D', "90d8", "1 3 2-1d8|1 2 2d10", 39, 125},
    {20, 90, "Ancient Black Dragon", 0x4F000300, 0x00201A07, 0x6005, 700, 2500,
     3, 'D', "90d8", "1 3 2-1d9|1 2 2d10", 39, 125},
    {15, 50, "Green Faerie Dragon", 0x41820302, 0x01001E93, 0x4001, 10, 500, 3,
     'F', "14d8", "4 8 1d3|3 3 2-2d5", 40, 0},
    {15, 45, "Giant Crocodile", 0x00000310, 0x00000000, 0xC000, 10, 1000, 2,
     'C', "125d8", "1 2 6d6|1 3 2-3d4|1 17 6d10", 40, 0},
    {10, 40, "Great White Shark", 0x00080050, 0x00000000, 0x9022, 0, 2750, 2,
     'S', "100d6", "1 2 3-15d4|1 25 2d20", 40, 90},
    {30, 50, "Queen Hag", 0x27100302, 0x000103A2, 0x4006, 200, 1150, 2, 'p',
     "60d6", "1 6 3d6|10 8 5d6|25 19 1d3", 40, 125},
    {5, 5, "Disenchanter Worms", 0x00200248, 0x00000000, 0x01B0, 100, 30, 0,
     'w', "10d8", "21 12 1d4", 40, 50},
    {20, 1, "Rotting Quythulg", 0x00010340, 0x00004010, 0x5000, 0, 1000, 2, 'Q',
     "12d8", "99 0 0d0", 40, 0},
    {20, 100, "Ancient Red Dragon", 0x7F000300, 0x00801E06, 0x6015, 500, 2750,
     3, 'D', "105d8", "1 3 2-1d10|1 2 2d14", 40, 125},
    {20, 80, "Death Quasit", 0x11030302, 0x000010FA, 0x0004, 0, 1000, 3, 'q',
     "55d8", "15 2 3d6|1 3 2-3d3", 40, 125},
    {20, 75, "Emperor Lich", 0x2F020300, 0x00019F72, 0x500C, 500, 10000, 2, 'L',
     "190d8", "15 5 2d12|19 5 46d8|24 5 0d0", 40, 150},
    {20, 100, "Ancient Multi-Hued Dragon", 0x7F000300, 0x00F89E05, 0x6005, 500,
     12000, 3, 'D', "260d8", "1 3 2-1d12|1 2 3d12", 40, 150},
    {20, 90, "Anti-<gp>", 0x32130000, 0x02815775, 0x7414, 600, 1500, 2, 'p',
     "160d8", "24 5 0d0|5 3 2-5d5|1 1 3d3", 42, 150},
    {20, 80, "Lesser Demon Lord", 0x321F0300, 0x02815775, 0x7414, 600, 1500, 2,
     'B', "75d8", "24 5 0d0|5 3 2-5d5|4 2 3d3", 42, 160},
    {15, 30, "Empress Hag", 0x4B100302, 0x001103A2, 0x4006, 100, 10000, 3, 'p',
     "100d6", "1 6 7d6|10 8 6d6|25 19 1d3", 45, 150},
    {20, 60, "Blue Faerie Dragon", 0x49820302, 0x01801E93, 0x4001, 5, 1000, 3,
     'F', "24d8", "4 8 2d5|3 3 2-2d8", 48, 0},
    {60, 80, "Sandgorgon", 0x441E0300, 0x00000000, 0x1002, 1, 1200, 4, 'S',
     "30d8", "1 3 2-4d8|1 2 2d10", 50, 0},
    {10, 45, "Tyranosaurus Rex", 0x000A0200, 0x00000000, 0xE022, 25, 6000, 2,
     'D', "200d8", "1 2 25d8|1 17 2-3d4", 50, 0},
    {20, 70, "Indigo Faerie Dragon", 0x51820302, 0x01801F13, 0x4001, 0, 2000, 3,
     'F', "39d8", "4 8 4d5|3 3 2-3d8", 56, 0},
    {5, 40, "Longsword  +7,+7  of Doom", 0x00880310, 0x80FA0001, 0x5404, 700,
     5000, 3, '|', "200d4", "1 1 2-12d8|19 10 46d8", 60, 0},
    {15, 65, "Death Knight", 0x47970300, 0x00810374, 0x5014, 75, 1400, 3, 'p',
     "90d8", "1 1 2-2d10", 60, 150},
    {25, 80, "Purple Faerie Dragon", 0x61820302, 0x01811D12, 0x4001, 0, 4500, 4,
     'F', "54d8", "4 8 6d5|3 3 2-4d8", 64, 0},
    {20, 100, "Chromatic Hydra  7-headed ", 0x7F000300, 0x01E89C05, 0x6005, 500,
     13000, 3, 'D', "300d8", "1 2 7-2d10", 70, 150},
    {25, 90, "Noble Faerie Dragon", 0x71830302, 0x01811D12, 0x4001, 0, 10000, 4,
     'F', "75d8", "4 8 10d5|3 3 2-5d8", 80, 0},
    {1, 0, "Wimp200", 0x00008000, 0x00000000, 0x0000, 1000, 0, 1, 'p', "1d1",
     "1 1 0d0", 99, 200},
    {1, 0, "Wimp220", 0x00008000, 0x00000000, 0x0000, 1000, 0, 1, 'p', "1d1",
     "1 1 0d0", 99, 220},
    {1, 0, "Wimp240", 0x00008000, 0x00000000, 0x0000, 1000, 0, 1, 'p', "1d1",
     "1 1 0d0", 99, 240},
    {1, 0, "Wimp255", 0x00008000, 0x00000000, 0x0000, 1000, 0, 1, 'p', "1d1",
     "1 1 0d0", 99, 255},
    {1, 0, "Wimp", 0x00008000, 0x00000000, 0x0000, 1000, 0, 1, 'p', "1d1",
     "1 1 0d0", 99, 0},
    {1, 0, "Wimp", 0x00008000, 0x00000000, 0x0000, 1000, 0, 1, 'p', "1d1",
     "1 1 0d0", 99, 0},
    {1, 0, "Wimp", 0x00008000, 0x00000000, 0x0000, 1000, 0, 1, 'p', "1d1",
     "1 1 0d0", 99, 0},
    {1, 0, "Wimp", 0x00008000, 0x00000000, 0x0000, 1000, 0, 1, 'p', "1d1",
     "1 1 0d0", 99, 0},
    {25, 100, "Emperor Faerie Dragon", 0x7D830302, 0x01811D12, 0x4001, 0, 25000,
     5, 'F', "105d8", "4 8 14d5|3 3 2-7d8", 100, 0},
    {20, 80, "Evil Iggy", 0x7F130300, 0x0201D713, 0x5004, 0, 18000, 3, 'p',
     "400d8", "2 1 4d6|13 19 0d0", 100, 175},
    {20, 125, "Balrog", 0xFF1F0300, 0x0281C743, 0x5404, 0, 55000, 4, 'B',
     "475d8", "5 1 10d12|1 17 8d12|24 5 0d0", 100, 255}};

static const long mon_mult_adj = 7; // High value slows multiplication

static void get_player_move_rate() {
  long cur_swim;

  /* with player_flags do; */
  if (is_in(cave[char_row][char_col].fval, earth_set)) {
    (player_flags).move_rate = 4;
  } else {
    cur_swim = (((player_flags).swim + randint(5) - 1) / 5);

    if (cur_swim <= -2) {
      (player_flags).move_rate = 0;
    } else if (cur_swim == -1) {
      (player_flags).move_rate = 1;
    } else if (cur_swim == 0) {
      (player_flags).move_rate = 2;
    } else if (cur_swim == 1) {
      (player_flags).move_rate = 4;
    } else {
      (player_flags).move_rate = 8;
    }
  }
}

/*{ Given speed, returns number of moves this turn.       -RAK-   }*/
/*{ NOTE: Player must always move at least once per iteration,    }*/
/*{       a slowed player is handled by moving monsters faster    }*/
static long movement_rate(long cspeed, long mon) {

  long final_rate;      /*{ final speed as long }*/
  long c_rate, py_rate; /*{ rate (0,1,2,3) = (0,1/4,1/2,1)
                             _                in wrong element }*/
  long return_value;

  /* with m_list[mon] do; */
  /* with monster_templates[mptr] do; */
  /* with cave[fy,fx] do; */
  uint8_t const monster_y = m_list[mon].fy;
  uint8_t const monster_x = m_list[mon].fx;
  if (xor((is_in(cave[monster_y][monster_x].fval, earth_set) ||
           is_in(cave[monster_y][monster_x].fval, pwall_set)),
          ((monster_templates[m_list[mon].mptr].cmove & 0x00000010) == 0))) {
    c_rate = (long)((monster_templates[m_list[mon].mptr].cmove & 0x00000300) / 256);
  } else {
    c_rate = 3;
  }

  if (c_rate == 3) {
    c_rate = 4; /* I wish I knew why they did this... rounding up? */
  }

  py_rate = player_flags.move_rate;

  if (cspeed > 0) {
    c_rate *= cspeed;
  } else {
    py_rate *= (2 - cspeed);
  }

  final_rate = c_rate / py_rate;

  if (((c_rate * turn) % py_rate) < (c_rate % py_rate)) {
    final_rate++;
  }

  /* { if player resting, max monster move = 1 } */
  if ((final_rate > 1) && (player_flags.rest > 0)) {
    return_value = 1;
  } else {
    return_value = final_rate;
  }

  return return_value;
}

void move_rec(long y1, long x1, long y2, long x2) {

  unsigned char i1;

  i1 = cave[y1][x1].cptr;
  cave[y1][x1].cptr = 0;
  cave[y2][x2].cptr = i1;
}

void check_mon_lite(long y, long x) {

  /* with cave[y][x]. do; */
  if (cave[y][x].cptr > 1) {
    if (!(m_list[cave[y][x].cptr].ml)) {
      if ((cave[y][x].tl) || (cave[y][x].pl)) {
        if (los(char_row, char_col, y, x)) {
          m_list[cave[y][x].cptr].ml = true;
          lite_spot(y, x);
        }
      }
    }
  }
}

void multiply_monster(long y, long x, long z, boolean slp) {
  long i1, i2, i3;

  i1 = 0;

  do {
    i2 = y - 2 + randint(3);
    i3 = x - 2 + randint(3);

    if (in_bounds(i2, i3)) {
      /* with cave[i2,i3] do; */
      if (is_in(cave[i2][i3].fval, floor_set)) {
        if ((cave[i2][i3].tptr == 0) && (cave[i2][i3].cptr != 1)) {
          if (cave[i2][i3].cptr > 1) { /* { Creature there already?
                                          }*/
            /*{ Some critters are
             * canabalistic!       }*/
            if ((monster_templates[z].cmove & 0x00080000) != 0) {
              delete_monster(cave[i2][i3].cptr);
              place_monster(i2, i3, z, slp);
              check_mon_lite(i2, i3);
              mon_tot_mult++;
            }
          } else {
            /*{ All clear, place a monster
             * }*/
            place_monster(i2, i3, z, slp);
            check_mon_lite(i2, i3);
            mon_tot_mult++;
          }
          i1 = 18;
        }
        i1++;
      }
    }
  } while (i1 <= 18);
}

/*//////////////////////////////////////////////////////////////////// */
/*//////////////////////////////////////////////////////////////////// */
/*///////////           Begin the insanity               ///////////// */

static void c__update_mon(long monptr, long *hear_count) {
  boolean flag;
  long h_range, s_range;

  /*  ENTER("c__update_mon", "c") */

  /* with m_list[monptr]. do; */
  /* with cave[MY(monptr)][MX(monptr)]. do; */
  flag = false;

  if ((is_in(cave[MY(monptr)][MX(monptr)].fval, water_set)) &&
      ((monster_templates[ML(monptr).mptr].cmove & 0x00800000) == 0)) {
    /*{in water, not flying}*/
    h_range = 10;
    s_range = 5;
  } else {
    h_range = -1;
    s_range = MAX_SIGHT;
  }

  if ((player_flags.blind < 1) && panel_contains(MY(monptr), MX(monptr))) {
    if (wizard2) {
      flag = true;
    } else if ((ML(monptr).cdis <= s_range)) {
      if (los(char_row, char_col, MY(monptr), MX(monptr))) {
        /* with monster_templates[mptr] do; */
        if ((cave[MY(monptr)][MX(monptr)].pl) ||
            (cave[MY(monptr)][MX(monptr)].tl)) { /*{can see creature?}*/
          flag = (player_flags.see_inv ||
                  ((0x10000 & monster_templates[ML(monptr).mptr].cmove) == 0));
        } else if (player_flags.see_infra > 0) { /*{infravision?}*/
          flag = ((ML(monptr).cdis <= player_flags.see_infra) &&
                  ((0x2000 & monster_templates[ML(monptr).mptr].cdefense) != 0));
        }
      }
    }
  }

  if ((ML(monptr).cdis <= h_range) && /*{noise in water?}*/
      los(char_row, char_col, MY(monptr), MX(monptr)) && (!flag)) {
    (*hear_count)++;
  }

  if (flag) {
    /*{ Light it up...        }*/
    if (!(ML(monptr).ml)) {
      print(monster_templates[ML(monptr).mptr].cchar, MY(monptr), MX(monptr));
      ML(monptr).ml = true;
      if (search_flag) {
        search_off();
      }
      if (player_flags.rest > 0) {
        rest_off();
      }
      flush();
      if (find_flag) {
        find_flag = false;
        player_action_move(5);
      }
    }
  } else if (ML(monptr).ml) {
    /*{ Turn it off...        }*/
    ML(monptr).ml = false;
    if ((cave[MY(monptr)][MX(monptr)].tl) ||
        (cave[MY(monptr)][MX(monptr)].pl)) {
      lite_spot(MY(monptr), MX(monptr));
    } else {
      unlite_spot(MY(monptr), MX(monptr));
    }
  }

  /*  LEAVE("c__update_mon", "c") */
}

static void c__monster_eaten_message(char const *squash, char const *doesit, long cptr) {
  char out_val[1026];

  ENTER(("c__monster_eaten_message", "c"));

  switch (randint(10)) {
  case 1:
    sprintf(out_val, "Uh oh...it looks like the %s is in need of first aid.",
            squash);
    break;

  case 2:
    sprintf(out_val, "*splat* *crunch* *gobble* *BUUUUUUURP*");
    break;

  case 3:
    sprintf(out_val, "Look out!  The %s is going to-- Eeeeew...never mind.",
            doesit);
    break;

  case 4:
    sprintf(out_val, "Ick...the %s has %s all over his toes.", doesit, squash);

    break;

  case 5:
    sprintf(out_val, "The nice %s took out the %s for you.", doesit, squash);
    break;

  case 6:
    sprintf(out_val, "WoWEE, Auggie Ben-Doggie!  The %s just got blatted!",
            squash);
    break;

  case 7:
    sprintf(out_val, "The %s Society will not appreciate this. . .", squash);
    break;

  case 8:
    sprintf(out_val, "The %s is not amused.", squash);
    break;

  case 9:
    sprintf(out_val, "The %s pauses to clean the %s off.", doesit, squash);
    break;

  case 10:
    sprintf(out_val, "Aw, darn.  There goes %ld experience!",
            (monster_templates[m_list[cptr].mptr].mexp));
    break;
  }

  msg_print(out_val);

  LEAVE("c__monster_eaten_message", "c");
}

static boolean c__check_for_hit(long monptr, long atype) {
  long level, armor_stuff;
  boolean flag = false;

  ENTER(("c__check_for_hit", "c"));

  level = monster_templates[m_list[monptr].mptr].level;
  armor_stuff = player_pac + player_ptoac;

  switch (atype) {
  case 1: /*{Normal attack  }*/
    flag = test_hit(60, level, 0, armor_stuff);
    break;

  case 2: /*{Poison Strength}*/
    flag = test_hit(-3, level, 0, armor_stuff);
    break;

  case 3: /*{Confusion attack}*/
    flag = test_hit(10, level, 0, armor_stuff);
    break;

  case 4: /*{Fear attack    }*/
    flag = test_hit(10, level, 0, armor_stuff);
    break;

  case 5: /*{Fire attack    }*/
    flag = test_hit(10, level, 0, armor_stuff);
    break;

  case 6: /*{Acid attack    }*/
    flag = test_hit(0, level, 0, armor_stuff);
    break;

  case 7: /*{Cold attack    }*/
    flag = test_hit(10, level, 0, armor_stuff);
    break;

  case 8: /*{Lightning attack}*/
    flag = test_hit(10, level, 0, armor_stuff);
    break;

  case 9: /*{Corrosion attack}*/
    flag = test_hit(0, level, 0, armor_stuff);
    break;

  case 10: /*{Blindness attack}*/
    flag = test_hit(2, level, 0, armor_stuff);
    break;

  case 11: /*{Paralysis attack}*/
    flag = test_hit(2, level, 0, armor_stuff);
    break;

  case 12: /*{Steal Money    }*/
    flag = test_hit(5, level, 0, player_lev) && (player_money[TOTAL_] > 0);
    break;

  case 13: /*{Steal Object   }*/
    flag = test_hit(2, level, 0, player_lev) && (inven_ctr > 0);
    break;

  case 14: /*{Poison         }*/
    flag = test_hit(5, level, 0, armor_stuff);
    break;

  case 15: /*{Lose dexterity}*/
    flag = test_hit(0, level, 0, armor_stuff);
    break;

  case 16: /*{Lose constitution}*/
    flag = test_hit(0, level, 0, armor_stuff);
    break;

  case 17: /*{Lose intelligence}*/
    flag = test_hit(2, level, 0, armor_stuff);
    break;

  case 18: /*{Lose wisdom}*/
    flag = test_hit(0, level, 0, armor_stuff);
    break;

  case 19: /*{Lose experience}*/
    flag = test_hit(5, level, 0, armor_stuff);
    break;

  case 20: /*{Aggravate monsters}*/
    flag = true;
    break;

  case 21: /*{Disenchant        }*/
    flag = test_hit(20, level, 0, armor_stuff);
    break;

  case 22: /*{Eat food          }*/
    flag = test_hit(5, level, 0, armor_stuff);
    break;

  case 23: /*{Eat light         }*/
    flag = test_hit(5, level, 0, armor_stuff);
    break;

  case 24: /*{Eat charges       }*/
    flag = test_hit(15, level, 0, armor_stuff);
    break;

  case 25: /*{Lose charisma     }*/
    flag = test_hit(2, level, 0, armor_stuff);
    break;

  case 26: /*{Petrification     }*/
    flag = test_hit(10, level, 0, armor_stuff);
    break;

  case 27: /*{POISON poison     }*/
    flag = test_hit(5, level, 0, armor_stuff);
    break;

  case 99: /* protevil or protmon repelled the attack */
    flag = true;
    break;

  default:
    flag = false;
    break;

  } /* end switch */

  RETURN("c__check_for_hit", "c", 'b', "test hit:", &flag);
  return flag;
}

static void c__print_attack(long adesc, char *cdesc) {
  char the_attack[134];
  boolean no_print = false;

  ENTER(("c__print_attack", "%ld,len: %d >%s<", adesc, strlen(cdesc), cdesc));
  strcpy(the_attack, cdesc);

  switch (adesc) {
  case 1:
    strcat(the_attack, "hits you.");
    break;
  case 2:
    strcat(the_attack, "bites you.");
    break;
  case 3:
    strcat(the_attack, "claws you.");
    break;
  case 4:
    strcat(the_attack, "stings you.");
    break;
  case 5:
    strcat(the_attack, "touches you.");
    break;
  case 6:
    strcat(the_attack, "kicks you.");
    break;
  case 7:
    strcat(the_attack, "gazes at you.");
    break;
  case 8:
    strcat(the_attack, "breathes on you.");
    break;
  case 9:
    strcat(the_attack, "spits on you.");
    break;
  case 10:
    strcat(the_attack, "makes a horrible wail.");
    break;
  case 11:
    strcat(the_attack, "embraces you.");
    break;
  case 12:
    strcat(the_attack, "crawls on you.");
    break;
  case 13:
    strcat(the_attack, "releases a cloud of spores.");
    break;
  case 14:
    strcat(the_attack, "begs you for money.");
    break;
  case 15:
    strcat(the_attack, "You've been slimed!");
    break;
  case 16:
    strcat(the_attack, "crushes you.");
    break;
  case 17:
    strcat(the_attack, "tramples you.");
    break;
  case 18:
    strcat(the_attack, "drools on you.");
    break;
  case 19:
    switch (randint(9)) {
    case 1:
      strcat(the_attack, "insults you!");
      break;
    case 2:
      strcat(the_attack, "insults your mother!");
      break;
    case 3:
      strcat(the_attack, "gives you the finger!");
      break;
    case 4:
      strcat(the_attack, "humiliates you!");
      break;
    case 5:
      strcat(the_attack, "wets on your leg!");
      break;
    case 6:
      strcat(the_attack, "defiles you!");
      break;
    case 7:
      strcat(the_attack, "dances around you!");
      break;
    case 8:
      strcat(the_attack, "makes obscene gestures!");
      break;
    case 9:
      strcat(the_attack, "moons you!!!");
      break;
    }
    break;
  case 23:
    strcat(the_attack, "sings a charming song");
    break;
  case 24:
    strcat(the_attack, "kisses you");
    break;
  case 25:
    strcat(the_attack, "gores you");
    break;
  case 26:
    switch (randint(2)) {
    case 1:
      strcat(the_attack, "moos forlornly");
      break;
    case 2:
      strcat(the_attack, "questioningly looks at you");
      break;
    }
    break;
  case 27:
    strcat(the_attack, "shocks you");
    break;
  case 28:
    strcat(the_attack, "squirts ink at you");
    break;
  case 29:
    strcat(the_attack, "entangles you");
    break;
  case 30:
    strcat(the_attack, "sucks your blood");
    break;
  case 31:
    strcat(the_attack, "goes for your throat!");
    break;
  case 32:
    strcat(the_attack, "blows bubbles at you");
    break;
  case 33:
    strcat(the_attack, "squawks at you");
    break;
  case 34:
    strcat(the_attack, "pecks at you");
    break;
  case 35:
    strcat(the_attack, "barks at you");
    break;
  case 36:
    strcat(the_attack, "rubs against your leg");
    break;
  case 37:
    strcat(the_attack, "follows you around");
    break;
  case 99:
    strcat(the_attack, "is repelled.");
    break;

  case 0:
  default:
    no_print = true;
    break;
  } /* end switch */

  if (!no_print) {
    msg_print(the_attack);
  }

  LEAVE("c__print_attack", "c");
}

static void c__apply_attack(long monptr, long atype, char ddesc[82],
                            char *damstr) {
  long dam, level, aning;
  long i1, i2, i4;
  boolean flag;
  treas_rec *item_ptr;
  obj_set food_stuffs = {Food, 0};
  obj_set staff_rod_or_wand = {staff, rod, wand, 0};

  ENTER(("c__apply_attack", "c"));

  level = monster_templates[m_list[monptr].mptr].level;

  switch (atype) {
  case 1: /*{Normal attack  }*/
    dam = damroll(damstr);
    /* with player_do; */
    dam -= (long)((((player_pac + player_ptoac) / 200.0) * dam) + .5);
    take_hit(dam, ddesc);
    prt_stat_block();
    break;

  case 2: /*{Poison Strength}*/
    take_hit(damroll(damstr), ddesc);
    lose_stat(STR, "You feel weaker.",
              "You feel weaker for a moment, then it passes.");
    prt_stat_block();
    break;

  case 3: /*{Confusion attack}*/
    /* with player_flags do; */
    take_hit(damroll(damstr), ddesc);
    if (randint(2) == 1) {
      if ((player_flags).confused < 1) {
        msg_print("You feel confused.");
        (player_flags).confused += randint(level);
      }
      (player_flags).confused += 3;
    }
    prt_stat_block();
    break;

  case 4: /*{Fear attack    }*/
    /* with player_flags do; */
    take_hit(damroll(damstr), ddesc);
    if (player_spell_saves()) {
      msg_print("You resist the effects!");
    } else if ((player_flags).afraid < 1) {
      msg_print("You are suddenly afraid!");
      (player_flags).afraid += 3 + randint(level);
    } else {
      (player_flags).afraid += 3;
    }
    prt_stat_block();
    break;

  case 5: /*{Fire attack    }*/
    msg_print("You are enveloped in flames!");
    fire_dam(damroll(damstr), ddesc);
    break;

  case 6: /*{Acid attack    }*/
    msg_print("You are covered in acid!");
    acid_dam(damroll(damstr), ddesc);
    break;

  case 7: /*{Cold attack    }*/
    msg_print("You are covered with frost!");
    cold_dam(damroll(damstr), ddesc);
    break;

  case 8: /*{Lightning attack}*/
    msg_print("Lightning strikes you!");
    light_dam(damroll(damstr), ddesc);
    break;

  case 9: /*{Corrosion attack}*/
    msg_print("A stinging red gas swirls about you.");
    corrode_gas(ddesc);
    take_hit(damroll(damstr), ddesc);
    prt_stat_block();
    break;

  case 10: /*{Blindness attack}*/
    /* with player_flags do; */
    take_hit(damroll(damstr), ddesc);
    if ((player_flags).blind < 1) {
      (player_flags).blind += 10 + randint(level);
      msg_print("Your eyes begin to sting.");
      msg_print(" ");
    }
    (player_flags).blind +=
        5; /* blind the first time is worse than cumulitave blind */
    prt_stat_block();
    break;

  case 11: /*{Paralysis attack}*/
    /* with player_flags do; */
    take_hit(damroll(damstr), ddesc);
    if (player_spell_saves()) {
      msg_print("You resist the effects!");
    } else if ((player_flags).paralysis < 1) {
      if ((player_flags).free_act || ((player_flags).free_time > 0)) {
        msg_print("You are unaffected.");
      } else {
        /* new paralysis overwrites old one, otherwise
         * you become dead fast */
        (player_flags).paralysis = randint(level) + 3;
        msg_print("You are paralyzed.");
      }
    }
    prt_stat_block();
    break;

  case 12: /*{Steal Money     }*/
    /* with player_do; */
    if ((randint(256) < (C_player_get_stat(DEX) * 10)) &&
        (player_flags.paralysis < 1)) {
      msg_print("You quickly protect your money pouch!");
    } else {
      if (player_money[TOTAL_] > 0) {
        subtract_money(randint(5) * (player_money[TOTAL_] * GOLD_VALUE) / 100,
                       false);
        msg_print("Your purse feels lighter.");
        prt_stat_block();
      }
    }
    if (randint(2) == 1) {

      msg_print("There is a puff of smoke!");
      teleport_away(monptr, MAX_SIGHT);
    }

    break;

  case 13: /*{Steal Object   }*/
    /* with py.stat do; */
    if ((randint(256) < (C_player_get_stat(DEX) * 10)) &&
        (player_flags.paralysis < 1)) {
      msg_print("You grab hold of your backpack!");
    } else {
      item_ptr = inventory_list;
      for (i1 = randint(inven_ctr) - 1; i1 > 0; --i1) {
        item_ptr = item_ptr->next;
        if (item_ptr != NULL) {
          break;
        }
      }
      if (item_ptr != NULL) {
        if (!item_ptr->is_in) {
          if ((item_ptr->data.flags2 & Holding_bit) != 0) {
            if (item_ptr->insides == 0) {
              inven_destroy(item_ptr);
            }
          } else {
            inven_destroy(item_ptr);
          }
        } else {
          inven_destroy(item_ptr);
        }
        prt_stat_block();
        msg_print("Your backpack feels lighter.");
      }
    }

    if (randint(2) == 1) {
      msg_print("There is a puff of smoke!");
      teleport_away(monptr, MAX_SIGHT);
    }

    break;

  case 14: /*{Poison         }*/
    /* with player_flags do ; */
    take_hit(damroll(damstr), ddesc);
    prt_stat_block();
    msg_print("You feel very sick.");
    (player_flags).poisoned += randint(level) + 5;
    break;

  case 15: /*{Lose dexterity }*/
    /* with player_flags do; */
    take_hit(damroll(damstr), ddesc);
    lose_stat(DEX, "You feel more clumsy",
              "You feel clumsy for a moment, then it passes.");
    prt_stat_block();
    break;

  case 16: /*{Lose constitution }*/
    /* with player_flags do; */
    take_hit(damroll(damstr), ddesc);
    lose_stat(CON, "Your health is damaged!",
              "Your body resists the effects of the disease.");
    prt_stat_block();
    break;

  case 17: /*{Lose intelligence }*/
    /* with player_flags do; */
    take_hit(damroll(damstr), ddesc);
    lose_stat(INT, "You feel your memories fading.",
              "You feel your memories fade, then they are restored!");
    prt_stat_block();
    break;

  case 18: /*{Lose wisdom      }*/
    /* with player_flags do; */
    take_hit(damroll(damstr), ddesc);
    lose_stat(WIS, "Your wisdom is drained.", "Your wisdom is sustained.");
    prt_stat_block();
    break;

  case 19: /*{Lose experience  }*/
    msg_print("You feel your life draining away!");
    i1 = damroll(damstr) + (player_exp / 100) * MON_DRAIN_LIFE;
    lose_exp(i1);
    break;

  case 20: /*{Aggravate monster}*/
    aggravate_monster(5);
    break;

  case 21: /*{Disenchant       }*/
    flag = false;
    switch (randint(8)) {
    case 1:
      i1 = Equipment_primary;
      break;
    case 2:
      i1 = Equipment_armor;
      break;
    case 3:
      i1 = Equipment_belt;
      break;
    case 4:
      i1 = Equipment_shield;
      break;
    case 5:
      i1 = Equipment_cloak;
      break;
    case 6:
      i1 = Equipment_gloves;
      break;
    case 7:
      i1 = Equipment_bracers;
      break;
    case 8:
      i1 = Equipment_helm;
      break;
    default:
      MSG(("ERROR: randint returned an out of range value in "
           "c__apply_attack"));
      i1 = Equipment_primary;
      break;
    }

    /* with equipment[i1] do; */
    if (equipment[i1].tohit > 0) {
      equipment[i1].tohit -= randint((equipment[i1].tohit == 1) ? 1 : 2);
      flag = true;
    }
    if (equipment[i1].todam > 0) {
      equipment[i1].todam -= randint((equipment[i1].todam == 1) ? 1 : 2);
      flag = true;
    }
    if (equipment[i1].toac > 0) {
      equipment[i1].toac -= randint((equipment[i1].toac == 1) ? 1 : 2);
      flag = true;
    }

    if (flag) {
      msg_print("There is a static feeling in the air...");
      py_bonuses(&blank_treasure, 1);
    }
    break;

  case 22: /*{Eat food         }*/
    if (find_range(food_stuffs, false, &item_ptr, &i2)) {
      inven_destroy(item_ptr);
      prt_stat_block();
    }
    break;

  case 23: /*{Eat light        }*/
    /* with equipment[Equipment_light] do; */
    if (equipment[Equipment_light].p1 > 0) {
      equipment[Equipment_light].p1 -= 250 + randint(250);
      if (equipment[Equipment_light].p1 < 1) {
        equipment[Equipment_light].p1 = 1;
      }
      msg_print("Your light dims...");
    }
    break;

  case 24: /*{Eat charges     }*/
    if (inven_ctr > 0) {
      item_ptr = inventory_list;
      aning = randint(inven_ctr) - 1;
      for (i1 = 1; i1 <= aning; i1++) {
        item_ptr = item_ptr->next;
      }
      i4 = level;
      /* with item_ptr^.data do; */
      if (is_in(item_ptr->data.tval, staff_rod_or_wand)) {
        if (item_ptr->data.p1 > 0) {
          m_list[monptr].hp += i4 * item_ptr->data.p1;
          item_ptr->data.p1 = 0;
        }
      }
      msg_print("Energy drains from your pack!");
    }
    break;

  case 25: /*{Lose charisma   }*/
    /* with player_flags do; */
    take_hit(damroll(damstr), ddesc);
    lose_stat(CHR, "Your skin starts to itch.",
              "Your skin starts to itch, but feels better now.");
    prt_stat_block();
    break;

  case 26: /*{Petrification  }*/
    /* with player_flags do; */
    petrify(m_list[monptr].hp);
    break;

  case 27: /*{POISON Poison  }*/
    /* with player_flags do; */
    (player_flags).poisoned += damroll(damstr);
    msg_print("You feel very sick.");
    break;

  case 99:
    break;

  default:
    break;
  } /* end switch */

  LEAVE("c__apply_attack", "c");
}

static void c__make_attack(long monptr) {
  /*{ Make an attack on the player (chuckle...)             -RAK-   }*/

  long atype;
  long adesc; /*,dam;*/
  long acount;
  long i5;
  char attstr[82];
  char attx[82];
  char cdesc[82];
  char ddesc[82];
  char s1[82];
  char theattack[120];
  boolean flag;
  char damstr[36];
  char *achar;

  ENTER(("c__make_attack", "c"));
  /* with m_list[monptr] do; */
  /* with monster_templates[m_list[monptr].mptr]. do; */

  attstr[0] = 0;
  attx[0] = 0;

  strcpy(attstr, monster_templates[m_list[monptr].mptr].damage);
  find_monster_name(cdesc, monptr, true);
  strcat(cdesc, " ");

  /*{ For "DIED_FROM" string        }*/
  if ((0x80000000 & monster_templates[m_list[monptr].mptr].cmove) != 0) {
    sprintf(ddesc, "The %s", monster_templates[m_list[monptr].mptr].name);
  } else {
    sprintf(ddesc, "& %s", monster_templates[m_list[monptr].mptr].name);
  }
  strcpy(inven_temp.data.name, ddesc);
  inven_temp.data.number = 1;
  objdes(ddesc, &inven_temp, true);
  strcpy(died_from, ddesc);
  /*{ End DIED_FROM                 }*/

  for (; attstr[0] != 0;) {

    /* attstr looks like this: "1 32 4d4|2 21 0d0" */
    achar = strchr(attstr, '|');
    if (achar != NULL) {
      strcpy(attx, attstr);
      achar = strchr(attx, '|');
      (*achar) = 0;
      achar++;
      strcpy(attstr, achar);
    } else {
      strcpy(attx, attstr);
      attstr[0] = 0;
    }

    sscanf(attx, "%ld %ld %s", &atype, &adesc, damstr);

    if (player_flags.protevil > 0) {
      if ((monster_templates[m_list[monptr].mptr].cdefense & 0x0004) != 0) {
        if ((player_lev + 1) > monster_templates[m_list[monptr].mptr].level) {
          atype = 99;
          adesc = 99;
        }
      }
    }

    if (player_flags.protmon > 0) {
      if ((monster_templates[m_list[monptr].mptr].cdefense & 0x0002) != 0) {
        if ((player_lev + 1) > monster_templates[m_list[monptr].mptr].level) {
          atype = 99;
          adesc = 99;
        }
      }
    }

    if ((achar = strstr(damstr, "-")) != NULL) {
      (*achar) = ' ';
      sscanf(damstr, "%ld %s", &acount, s1);
      strcpy(damstr, s1);
    } else {
      acount = 1;
    }

    /* with player_do; */
    for (i5 = 1; i5 <= acount; i5++) {

      flag = c__check_for_hit(monptr, atype);

      if (flag) {
        c__print_attack(adesc, cdesc);
        c__apply_attack(monptr, atype, ddesc, damstr);
      } else {
        switch (adesc) {
        case 1:
        case 2:
        case 3:
        case 6:
          /* normal, poison strength, confusion
           * attack, acid attack */
          sprintf(theattack, "%smisses you.", cdesc);
          msg_print(theattack);
          break;
        default:
          break;
        }
      }
    } /* end for i5 */
  }   /* end for attstr != null */

  LEAVE("c__make_attack", "c");
}

static boolean c__make_move(long monptr, mm_type mm, long *hear_count) {
  /*{ Make the move if possible, five choices               -RAK-   }*/

  long i1, i2, newy, newx;
  unsigned long movebits;
  boolean flag, tflag;
  char out_val[82];
  boolean return_value = false;

  ENTER(("c__make_move", "c"));

  i1 = 1;
  flag = false;
  movebits = monster_templates[m_list[monptr].mptr].cmove;

  do {
    /*{ Get new positon               }*/
    newy = m_list[monptr].fy;
    newx = m_list[monptr].fx;
    move_dir(mm[i1], &newy, &newx);
    /* with cave[newy][newx]. do; */
    if (cave[newy][newx].fval != boundry_wall.ftval) {
      tflag = false;
      if (cave[newy][newx].cptr == 1) {
        tflag = true;
      } else if (cave[newy][newx].fopen) {
        if (is_in(cave[newy][newx].fval, floor_set)) {
          if ((movebits & 0x00000040) == 0) {
            tflag = true;
          } else if (!xor((is_in(cave[newy][newx].fval, earth_set)),
                          ((movebits & 0x00000010) == 0))) {
            tflag = true;
          }
        }
        /*{ Creature moves through walls? }*/
      } else if ((movebits & 0x40000) != 0) {
        tflag = true;
        /*{ Creature can open doors?      }*/
      } else if (cave[newy][newx].tptr > 0) {

        /* with t_list[cave[newy][newx].tptr]. do; */
        /* with m_list[monptr]. do; */
        if ((movebits & 0x20000) != 0) {
          /*{ Creature can open doors... }*/
          switch (t_list[cave[newy][newx].tptr].tval) {
          case closed_door:                              /*{ Closed doors...
                                                            }*/
            if (t_list[cave[newy][newx].tptr].p1 == 0) { /*{ Closed doors  }*/
              tflag = true;
              if (cave[newy][newx].fm) {
                if (los(char_row, char_col, newy, newx)) {
                  t_list[cave[newy][newx].tptr] = door_list[DL_OPEN];
                  cave[newy][newx].fopen = true;
                  lite_spot(newy, newx);
                  tflag = false;
                }
              }
            } else if (t_list[cave[newy][newx].tptr].p1 > 0) {
              /*{ Locked doors  }*/
              if (randint(100 - monster_templates[m_list[monptr].mptr].level) < 5) {
                t_list[cave[newy][newx].tptr].p1 = 0;
              }
            } else if (t_list[cave[newy][newx].tptr].p1 < 0) {
              /*{ Stuck doors   }*/
              if (randint(m_list[monptr].hp) >
                  (10 + labs(t_list[cave[newy][newx].tptr].p1))) {
                t_list[cave[newy][newx].tptr].p1 = 0;
              }
            }
            break;

          case secret_door: /*{ Secret doors...
                               }*/
            tflag = true;
            if (cave[newy][newx].fm) {
              if (los(char_row, char_col, newy, newx)) {
                t_list[cave[newy][newx].tptr] = door_list[DL_OPEN];
                cave[newy][newx].fopen = true;
                lite_spot(newy, newx);
                tflag = false;
              }
            }
            break;

          default:
            break;
          }
        } else {
          /*  { Creature can not open doors, must
           * bash them   }*/
          switch (t_list[cave[newy][newx].tptr].tval) {
          case closed_door: /* { Closed doors...
                               }*/
            i2 = labs(t_list[cave[newy][newx].tptr].p1) + 20;
            if (randint(m_list[monptr].hp) > i2) {
              tflag = true;
              if (cave[newy][newx].fm) {
                if (los(char_row, char_col, newy, newx)) {
                  t_list[cave[newy][newx].tptr] = door_list[DL_OPEN];
                  t_list[cave[newy][newx].tptr].p1 = randint(2) - 1;
                  cave[newy][newx].fopen = true;
                  lite_spot(newy, newx);
                  tflag = false;
                }
              }
            }
            break;

          case secret_door: /* { Secret doors...
                               }*/
            break;

          default:
            break;
          }
        }
      }

      /* { Glyph of warding present?     }*/
      if (tflag) {
        if (cave[newy][newx].tptr > 0) {
          if (t_list[cave[newy][newx].tptr].tval == seen_trap) {
            if (t_list[cave[newy][newx].tptr].subval == 99) {
              if (randint(OBJ_RUNE_PROT) < monster_templates[m_list[monptr].mptr].level) {
                if ((newy == char_row) && (newx == char_col)) {
                  msg_print("Th"
                            "e "
                            "ru"
                            "ne"
                            " o"
                            "f "
                            "pr"
                            "ot"
                            "ec"
                            "ti"
                            "on"
                            " i"
                            "s "
                            "br"
                            "ok"
                            "en"
                            "!");
                }
                delete_object(newy, newx);
              } else {
                tflag = false;
              }
            }
          }
        }
      }

      /* { Creature has attempted to move on player?     }*/
      if (tflag) {
        if (cave[newy][newx].cptr == 1) {

          if (!(m_list[monptr].ml)) {
            c__update_mon(monptr, hear_count);
          }

          if (find_flag) {
            find_flag = false;
            player_action_move(5);
          }

          c__make_attack(monptr);
          /* { Player has read a Confuse Monster?
           * }*/
          /* { Monster gets a saving throw... }*/
          if (player_flags.confuse_monster) {
            /* with m_list[monptr] do; */
            /* with */
            /* monster_templates[m_list[monptr].mptr].
             */
            /* do; */
            msg_print("Your hands stop glowing.");
            player_flags.confuse_monster = false;
            if (mon_save(monptr, 0, SC_MENTAL)) {
              sprintf(out_val,
                      "The %s is "
                      "unaffected.",
                      monster_templates[m_list[monptr].mptr].name);
            } else {
              sprintf(out_val,
                      "The %s appears "
                      "confused.",
                      monster_templates[m_list[monptr].mptr].name);
              m_list[monptr].confused = true;
            }
            msg_print(out_val);
          }
          tflag = false;
          flag = true;

        } else { /* cptr != 1 */

          /*{ Creature is attempting to move on
           * other creature?     }*/
          if ((cave[newy][newx].cptr > 1) &&
              ((newy != m_list[monptr].fy) || (newx != m_list[monptr].fx))) {

            /*{ Creature eats other
             * creatures?        }*/
            if ((movebits & 0x80000) != 0) {
              if (m_list[cave[newy][newx].cptr].ml) {
                /*squash =
                 * monster_templates[m_list[cptr].mptr].name;*/
                /*doesit =
                 * monster_templates[m_list[monptr].mptr].name;*/
                c__monster_eaten_message(
                    monster_templates[m_list[cave[newy][newx].cptr].mptr].name,
                    monster_templates[m_list[monptr].mptr].name, cave[newy][newx].cptr);
              }
              delete_monster(cave[newy][newx].cptr);
            } else {
              tflag = false;
            }
          }
        }
      } /* end if tflag */

      /*{ Creature has been allowed move...     }*/
      if (tflag) {
        /* with m_list[monptr] do */

        /*{ Pick up or eat an object              }*/
        if ((movebits & 0x100000) != 0) {
          /* with cave[newy,newx] do; */
          if (cave[newy][newx].tptr > 0) {
            if (t_list[cave[newy][newx].tptr].tval < valuable_metal) {
              delete_object(newy, newx);
            }
          }
        }

        /*{ Move creature record                  }*/
        move_rec(m_list[monptr].fy, m_list[monptr].fx, newy, newx);
        m_list[monptr].fy = newy;
        m_list[monptr].fx = newx;
        flag = true;
        return_value = true;
      }
    }
    i1++;
    /*{ Up to 5 attempts at moving, then give up...   }*/
  } while (!(flag || (i1 > 5)));

  RETURN("c__make_move", "c", 'b', "moved", &return_value);
  return return_value;
}

static boolean c__move_confused(long monptr, mm_type mm, long *hear_count) {
  boolean return_value;

  ENTER(("c__move_confused", "c"));

  mm[1] = randint(9);
  mm[2] = randint(9);
  mm[3] = randint(9);
  mm[4] = randint(9);
  mm[5] = randint(9);
  return_value = c__make_move(monptr, mm, hear_count);

  RETURN("c__move_confused", "c", 'b', "moved", &return_value);
  return return_value;
}

static void c__get_moves(long monptr, mm_type *mm) {
  /*{ Choose correct directions for monster movement        -RAK-   }*/

  long y, x;
  long move_val, octant_side;

  ENTER(("c__get_moves", "c"));
  /*{ octant_side = +/-1 }*/

  if (m_list[monptr].csleep != 0) {
    m_list[monptr].csleep = 0;
  }

  y = char_row - m_list[monptr].fy;
  x = char_col - m_list[monptr].fx;

  move_val = get_hexdecant(y, x);
  octant_side = 2 * (move_val % 2) - 1;

  (*mm)[1] = key_of[move_val / 2];
  (*mm)[2] = rotate_dir((*mm)[1], octant_side);
  (*mm)[3] = rotate_dir((*mm)[1], -octant_side);
  (*mm)[4] = rotate_dir((*mm)[2], octant_side);
  (*mm)[5] = rotate_dir((*mm)[3], -octant_side);

  LEAVE("c__get_moves", "c");
}

static boolean c__cast_spell(long monptr, boolean *took_turn) {
  /*{ Creatures can cast spells too.  (Dragon Breath)       -RAK-   }*/
  /*{ cast_spell := true if creature changes position       }*/
  /*{ took_turn  := true if creature casts a spell          }*/

  unsigned long i1;
  long i2;
  long i3;
  long y;
  long x;
  long chance2;
  long chance;
  long thrown_spell;
  float r1;
  long spell_choice[32]; /* [1..31] of long;*/
  char cdesc[82];
  char ddesc[82];
  char outval[120];
  boolean stop_player;
  boolean return_value;

  ENTER(("c__cast_spell", "c"));
  /* with m_list[monptr] do; */
  /* with monster_templates[m_list[monptr].mptr] do; */
  chance = ((monster_templates[m_list[monptr].mptr].spells & 0x0000000F));
  chance2 = ((monster_templates[m_list[monptr].mptr].spells & 0x80000000));

  /*{ 1 in x chance of casting spell                }*/
  /*{ if chance2 is true then 1 in x of not casting }*/
  if (((chance2 == 0) && (randint(chance) != 1)) ||
      ((chance2 != 0) && (randint(chance) == 1))) {

    return_value = false;
    *took_turn = false;

    /*{ Must be within certain range                  }*/
  } else if (m_list[monptr].cdis > MAX_SPELL_DIS) {

    return_value = false;
    *took_turn = false;

    /*{ Must have unobstructed Line-Of-Sight          }*/
  } else if (!(los(char_row, char_col, m_list[monptr].fy, m_list[monptr].fx))) {

    return_value = false;
    *took_turn = false;

  } else { /*{ Creature is going to cast a spell     }*/

    *took_turn = true;
    return_value = false;

    /*{ Describe the attack                           }*/
    find_monster_name(cdesc, monptr, true);
    strcat(cdesc, " ");
    /*{ For "DIED_FROM" string  }*/
    if ((0x80000000 & monster_templates[m_list[monptr].mptr].cmove) != 0) {
      sprintf(ddesc, "The %s", monster_templates[m_list[monptr].mptr].name);
    } else {
      sprintf(ddesc, "& %s", monster_templates[m_list[monptr].mptr].name);
    }
    strcpy(inven_temp.data.name, ddesc);
    inven_temp.data.number = 1;
    objdes(ddesc, &inven_temp, true);
    /*{ End DIED_FROM                 }*/

    /*{ Extract all possible spells into spell_choice }*/
    i1 = (monster_templates[m_list[monptr].mptr].spells & 0x0FFFFFF0);
    i3 = 0;
    for (; i1 != 0;) {
      i2 = bit_pos(&i1) + 1;
      i3++;
      spell_choice[i3] = i2;
    }

    /*{ Choose a spell to cast                        }*/
    thrown_spell = spell_choice[randint(i3)];
    stop_player = false;

    /*{ Cast the spell...                             }*/
    switch (thrown_spell) {
    case 5: /*{Teleport Short}*/
      teleport_away(monptr, 5);
      return_value = true;
      break;

    case 6: /*{Teleport Long }*/
      teleport_away(monptr, MAX_SIGHT);
      return_value = true;
      break;

    case 7: /*{Teleport To   }*/
      stop_player = true;
      strcat(cdesc, "casts a spell.");
      msg_print(cdesc);
      msg_print(" ");
      teleport_to(m_list[monptr].fy, m_list[monptr].fx);
      break;

    case 8: /*{Light Wound   }*/
      stop_player = true;
      if ((strstr(cdesc, "Bard") != NULL) ||
          (strstr(cdesc, "Ranger") != NULL) ||
          (strstr(cdesc, "Master Bard") != NULL)) {
        strcat(cdesc, "shoots an arrow.");
      } else {
        strcat(cdesc, "casts a spell.");
      }
      msg_print(cdesc);
      if (player_spell_saves()) {
        msg_print("You resist the effects of the spell.");
      } else {
        take_hit(damroll("3d8"), ddesc);
      }
      break;

    case 9: /*{Serious Wound }*/
      stop_player = true;
      strcat(cdesc, "casts a spell.");
      msg_print(cdesc);
      if (player_spell_saves()) {
        msg_print("You resist the affects of the spell.");
      } else {
        take_hit(damroll("8d8"), ddesc);
      }
      break;

    case 10: /*{Hold Person   }*/
      stop_player = true;
      strcat(cdesc, "casts a spell.");
      msg_print(cdesc);
      if ((player_flags).free_act || ((player_flags).free_time > 0)) {
        msg_print("You are unaffected...");
      } else if (player_spell_saves()) {
        msg_print("You resist the affects of the spell.");
      } else {
        msg_print("You can't move!");
        if ((player_flags).paralysis > 0) {
          (player_flags).paralysis += 2;
        } else {
          (player_flags).paralysis = randint(5) + 4;
        }
      }
      break;

    case 11: /*{Cause Blindnes}*/
      stop_player = true;
      strcat(cdesc, "casts a spell.");
      msg_print(cdesc);
      if (player_spell_saves()) {
        msg_print("You resist the affects of the spell.");
      } else if (player_flags.blind > 0) {
        player_flags.blind += 6;
      } else {
        player_flags.blind = 12 + randint(3);
        msg_print(" ");
      }
      break;

    case 12: /*{Cause Confuse }*/
      stop_player = true;
      strcat(cdesc, "casts a spell.");
      msg_print(cdesc);
      if (player_spell_saves()) {
        msg_print("You resist the affects of the spell.");
      } else if (player_flags.confused > 0) {
        player_flags.confused += 2;
      } else {
        player_flags.confused = randint(5) + 3;
      }
      break;

    case 13: /*{Cause Fear    }*/
      stop_player = true;
      strcat(cdesc, "casts a spell.");
      msg_print(cdesc);
      if (player_spell_saves()) {
        msg_print("You resist the affects of the spell.");
      } else if (player_flags.afraid > 0) {
        player_flags.afraid += 2;
      } else {
        player_flags.afraid = randint(5) + 3;
      }
      break;

    case 14: /*{Summon Monster}*/
      stop_player = true;
      strcat(cdesc, "magically summons a monster!");
      msg_print(cdesc);
      y = char_row;
      x = char_col;
      if (is_in(cave[y][x].fval, water_set)) {
        summon_water_monster(&y, &x, false);
      } else {
        summon_land_monster(&y, &x, false);
      }
      check_mon_lite(y, x);
      break;

    case 15: /*{Summon Undead}*/
      stop_player = true;
      strcat(cdesc, "magically summons an undead!");
      msg_print(cdesc);
      y = char_row;
      x = char_col;
      summon_undead(&y, &x);
      check_mon_lite(y, x);
      break;

    case 16: /*{Slow Person  }*/
      /* with player_flags do; */
      stop_player = true;
      strcat(cdesc, "casts a spell.");
      msg_print(cdesc);
      if ((player_flags).free_act || ((player_flags).free_time > 0)) {
        msg_print("You are unaffected...");
      } else if (player_spell_saves()) {
        msg_print("You resist the affects of the spell.");
      } else if ((player_flags).slow > 0) {
        (player_flags).slow += 2;
      } else {
        (player_flags).slow = randint(5) + 3;
      }
      break;

    case 17:
      if (trunc(player_cmana) > 0) { /*{Drain Mana   }*/
        stop_player = true;
        sprintf(outval, "%sdraws psychic energy from you!", cdesc);
        msg_print(outval);
        sprintf(outval, "%sappears healthier...", cdesc);
        msg_print(outval);
        r1 = (randint(monster_templates[m_list[monptr].mptr].level) / 2) + 1;
        if (r1 > player_cmana) {
          r1 = player_cmana;
        }
        player_cmana -= r1;
        m_list[monptr].hp += 6 * trunc(r1);
      }
      break;

    case 18: /*{Breath Evil  }*/
      stop_player = true;
      if (strstr(cdesc, "High Priest") != NULL) {
        strcat(cdesc, "throws a cloud of black vapors at you!");
      } else {
        strcat(cdesc, "breathes black vapors around you!");
      }
      msg_print(cdesc);
      i1 = (player_exp / 100) * MON_DRAIN_LIFE;
      breath(SE_EVIL, char_row, char_col, 1, ddesc);

      break;

    case 19: /*{Breath Petrify }*/
      stop_player = true;
      strcat(cdesc, "breathes petrifying gas at you!");
      msg_print(cdesc);
      breath(SE_PETRIFY, char_row, char_col, 1, ddesc);
      break;

    case 20: /*{Breath Light }*/
      stop_player = true;
      if ((strstr(cdesc, "Druid") != NULL) ||
          (strstr(cdesc, "Titan") != NULL)) {
        strcat(cdesc, "casts a spell.");
      } else {
        strcat(cdesc, "breathes lightning.");
      }
      msg_print(cdesc);
      if ((strstr(cdesc, "Druid") != NULL) ||
          (strstr(cdesc, "Titan") != NULL)) {
        breath(SE_LIGHTNING, char_row, char_col, 32, ddesc);
      } else {
        breath(SE_LIGHTNING, char_row, char_col,
               (long)(m_list[monptr].hp / 4.0), ddesc);
      }
      break;

    case 21: /*{Breath Gas   }*/
      stop_player = true;
      strcat(cdesc, "breathes gas.");
      msg_print(cdesc);
      breath(SE_GAS, char_row, char_col, (long)(m_list[monptr].hp / 3.0),
             ddesc);
      break;

    case 22: /*{Breath Acid  }*/
      stop_player = true;
      strcat(cdesc, "breathes acid.");
      msg_print(cdesc);
      breath(SE_ACID, char_row, char_col, (long)(m_list[monptr].hp / 3.0),
             ddesc);
      break;

    case 23: /*{Breath Frost }*/
      stop_player = true;
      strcat(cdesc, "breathes frost.");
      msg_print(cdesc);
      breath(SE_COLD, char_row, char_col, (long)(m_list[monptr].hp / 3.0),
             ddesc);
      break;

    case 24: /*{Breath Fire  }*/
      stop_player = true;
      if (strstr(cdesc, "Heirophant Druid") != NULL) {
        strcat(cdesc, "casts a spell.");
      } else {
        strcat(cdesc, "breathes fire.");
      }
      msg_print(cdesc);
      if (strstr(cdesc, "Heirophant Druid") != NULL) {
        breath(SE_FIRE, char_row, char_col, 48, ddesc);
      } else {
        breath(SE_FIRE, char_row, char_col, (long)(m_list[monptr].hp / 3.0),
               ddesc);
      }
      break;

    case 25: /*{Cast Illusion }*/
      stop_player = true;
      strcat(cdesc, "casts a spell.");
      msg_print(cdesc);
      if (player_spell_saves()) {
        msg_print("You resist the affects of the spell.");
      } else if (player_flags.image > 0) {
        player_flags.image += 2;
      } else {
        player_flags.image = randint(20) + 10;
      }
      break;

    case 26: /*{Summon Demon}*/
      stop_player = true;
      strcat(cdesc, "magically summons a demon!");
      msg_print(cdesc);
      y = char_row;
      x = char_col;
      summon_demon(&y, &x);
      check_mon_lite(y, x);
      break;

    case 27: /*{Summon Breed }*/
      stop_player = true;
      strcat(cdesc, "magically summons a monster!");
      msg_print(cdesc);
      y = char_row;
      x = char_col;
      summon_breed(&y, &x);
      check_mon_lite(y, x);
      break;

    case 28: /*{Stoning Gaze}*/
      stop_player = true;
      strcat(cdesc, "gazes at you!");
      msg_print(cdesc);
      if (player_spell_saves()) {
        msg_print("You resist the affects!");
      } else {
        /* XXXX hit points of monster sets petrify?? */
        petrify(m_list[monptr].hp);
      }
      break;

    default:
      stop_player = true;
      msg_print("Lucky you, creature casts unknown spell.");
      cdesc[0] = 0;

      MSG(("ERROR: cast bad spell: i3 = %ld "
           "spell_choice[i3] = %ld\n       "
           "monster = >%s<\n",
           i3, spell_choice[i3], monster_templates[m_list[monptr].mptr].name));
      break;
    }

    /*{ End of spells                                 }*/

    /*{ Stop player if in find mode   -DCJ/KRC-       }*/
    if (stop_player) {
      if (find_flag) {
        find_flag = false;
        player_action_move(5);
      }
      if ((player_flags).rest > 0) {
        rest_off();
      }
    }
  }
  RETURN("c__cast_spell", "c", 'b', "moved", &return_value);
  return return_value;
}

static boolean mon_move(long monptr, long *hear_count) {
  /*{ Move the critters about the dungeon                   -RAK-   }*/

  long i1, i2, i3;
  mm_type mm;
  boolean move_test;
  boolean return_value = false;

  ENTER(("mon_move", "c"));
  /* with monster_templates[m_list[monptr].mptr] do; */

  /*{ Does the creature regenerate?                         }*/
  if ((monster_templates[ML(monptr).mptr].cdefense & 0x8000) != 0) {
    m_list[monptr].hp += randint(4);
  }

  if (m_list[monptr].hp > max_hp(monster_templates[ML(monptr).mptr].hd)) {
    m_list[monptr].hp = max_hp(monster_templates[ML(monptr).mptr].hd);
  }

  /*{ Does the critter multiply?                            }*/
  if ((monster_templates[ML(monptr).mptr].cmove & 0x00200000) != 0) {
    if (MAX_MON_MULT >= mon_tot_mult) {
      if ((player_flags.rest % mon_mult_adj) == 0) {
        /* with m_list[monptr] do; */
        i3 = 0;

        for (i1 = MY(monptr) - 1; i1 <= MY(monptr) + 1; i1++) {
          for (i2 = MX(monptr) - 1; i2 <= MX(monptr) + 1; i2++) {
            if (in_bounds(i1, i2)) {
              if (cave[i1][i2].cptr > 1) {
                i3++;
              }
            }
          }
        }

        if (i3 < 4) {
          if (randint(i3 * mon_mult_adj) == 1) {
            multiply_monster(MY(monptr), MX(monptr), ML(monptr).mptr, false);
          }
        }
      }
    }
  }

  /*{ Creature is confused?  Chance it becomes un-confused  }*/
  move_test = false;

  if (m_list[monptr].confused) {
    return_value = c__move_confused(monptr, mm, hear_count);
    m_list[monptr].confused = (randint(8) != 1);
    move_test = true;
  } else if (monster_templates[ML(monptr).mptr].spells > 0) {
    /*{ Creature may cast a spell                             }*/
    return_value = c__cast_spell(monptr, &move_test);
  }

  if (!(move_test)) {

    /*{ 75% random movement                                   }*/
    if ((randint(100) <= 75) &&
        ((monster_templates[ML(monptr).mptr].cmove & 0x00000008) != 0)) {
      return_value = c__move_confused(monptr, mm, hear_count);

      /*{ 40% random movement }*/
    } else if ((randint(100) <= 40) &&
               ((monster_templates[ML(monptr).mptr].cmove & 0x00000004) != 0)) {
      return_value = c__move_confused(monptr, mm, hear_count);

      /*{ 20% random movement }*/
    } else if ((randint(100) <= 20) &&
               ((monster_templates[ML(monptr).mptr].cmove & 0x00000002) != 0)) {
      return_value = c__move_confused(monptr, mm, hear_count);

      /*{ Normal movement }*/
    } else if ((monster_templates[ML(monptr).mptr].cmove & 0x00000001) == 0) {
      if (randint(200) == 1) {
        return_value = c__move_confused(monptr, mm, hear_count);
      } else {
        c__get_moves(monptr, &mm);
        return_value = c__make_move(monptr, mm, hear_count);
      }

      /*{ Attack, but don't move }*/
    } else {
      if (m_list[monptr].cdis < 2) {
        c__get_moves(monptr, &mm);
        return_value = c__make_move(monptr, mm, hear_count);
      }
    }
  }

  RETURN("mon_move", "c", 'b', "moved", &return_value);
  return return_value;
}

static void c__splash(long monptr) {
  long i1, mon_swimming, drown_dam;

  ENTER(("c__splash", "c"));
  /* with m_list[monptr]. do; */
  /* with monster_templates[m_list[monptr].mptr]. do begin; */
  mon_swimming =
      (long)(((monster_templates[m_list[monptr].mptr].cmove & 0x00000700)) / 256);
  drown_dam = randint(OUT_OF_ENV_DAM);

  /*{ here will also be modifiers due to waterspeed,depth }*/
  /*{ divide damage by 2 for each mon_swimming level, random
    rounding procedure }*/
  for (i1 = 1; i1 <= mon_swimming; i1++) {
    drown_dam = (drown_dam + (randint(3) - 1)) / 3; /* kinda large for a 2 */
  }

  m_list[monptr].hp -= drown_dam;
  m_list[monptr].csleep = 0;

  if (m_list[monptr].hp < 0) {
    monster_death(m_list[monptr].fy, m_list[monptr].fx,
                  monster_templates[m_list[monptr].mptr].cmove);
    /* with cave[fy,fx] do; */
    delete_monster(cave[m_list[monptr].fy][m_list[monptr].fx].cptr);
  }

  LEAVE("c__splash", "c");
}

void creatures(boolean attack) {
  long i1, i2, i3, moldy, moldx;
  long hear_count;

  ENTER(("creatures", "c"));
  /*{ Main procedure for creatures                              -RAK- }*/
  if (1) {
    get_player_move_rate();

    if (muptr > 0) {

      /*{ Process the monsters  }*/
      hear_count = 0;
      i1 = muptr;
      do {
        /* with m_list[i1]. do; */
        m_list[i1].cdis =
            distance(char_row, char_col, m_list[i1].fy, m_list[i1].fx);
        if (attack) { /*{ Attack is argument passed to
                         CREATURE}*/
          i3 = movement_rate(m_list[i1].cspeed, i1);
          if (i3 > 0) {
            for (i2 = 1; i2 <= i3; i2++) {
              if ((m_list[i1].cdis <= monster_templates[m_list[i1].mptr].aaf) ||
                  (m_list[i1].ml)) {
                if (m_list[i1].csleep > 0) {
                  if (player_flags.aggravate) {
                    m_list[i1].csleep = 0;
                  } else if (player_flags.rest < 1) {
                    if (randint(10) > player_stl) {
                      m_list[i1].csleep -= (long)(75.0 / m_list[i1].cdis);
                    }
                  }
                }
                if (m_list[i1].stunned > 0) {
                  m_list[i1].stunned--;
                }
                if ((m_list[i1].csleep <= 0) && (m_list[i1].stunned <= 0)) {
                  moldy = m_list[i1].fy;
                  moldx = m_list[i1].fx;
                  if (mon_move(i1, &hear_count)) {
                    if (m_list[i1].ml) {
                      m_list[i1].ml = false;
                      if (test_light(moldy, moldx)) {
                        lite_spot(moldy, moldx);
                      } else {
                        unlite_spot(moldy, moldx);
                      }
                    }
                  }
                }
              } /* end if (cdis < aaf)
                   || ml */
              c__update_mon(i1, &hear_count);
            } /*{end for 1 to i3 loop}*/
          } else {
            c__update_mon(i1, &hear_count);
          }
        } else { /*{if attacking}*/
          c__update_mon(i1, &hear_count);
        }

        if (is_in(cave[m_list[i1].fy][m_list[i1].fx].fval, floor_set)) {
          if (((is_in(cave[m_list[i1].fy][m_list[i1].fx].fval, water_set)) !=
               ((monster_templates[m_list[i1].mptr].cmove & 0x00000010) != 0)) &&
              ((monster_templates[m_list[i1].mptr].cmove & 0x00000040) != 0)) {
            c__splash(i1);
          }
        }

        i1 = m_list[i1].nptr;
      } while (!((i1 == 0) || (moria_flag)));

      if (want_warn) {
        if (hear_count == 1) {
          msg_print("You hear a noise in the water.");
        } else if (hear_count > 1) {
          msg_print("You hear some noises in the "
                    "water.");
        }
      }
    }
    /*{ End processing monsters       }*/
  }
  LEAVE("creatures", "c");
}

long find_mon(const char *virtual_name) {

  long count;
  boolean maybe = false;

  for (count = 1; (count <= MAX_CREATURES) && !maybe;) {
    if (!strcmp(virtual_name, monster_templates[count].name)) {
      maybe = true;
    } else {
      count++;
    }
  }
  if (!maybe) {
    count = 0;
  }
  return count;
}
